(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"3HR4":function(e,t,s){"use strict";var o=s("o0o1"),a=s.n(o),i=s("L2JU"),r=s("8BOd");s("i8R7");function n(e,t,s,o,a,i,r){try{var n=e[i](r),c=n.value}catch(e){return void s(e)}n.done?t(c):Promise.resolve(c).then(o,a)}function c(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function u(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?c(Object(s),!0).forEach((function(t){m(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function m(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}t.a={components:{},data:function(){return{formData:{},formErrors:{},initialFormData:null,initianLength:0,emptyFormData:null,entity:null,preRequisite:{},isLoading:!0,useUserPreference:!1,dataType:null,configType:""}},computed:u(u({},Object(i.c)("config",{configsWithPreference:"configs",configs:"configsOriginal",vars:"vars"})),{},{formHasErrors:function(){var e=!1;return this.formErrors.objForEach((function(t){e=""!==t||e})),e}}),methods:u(u(u(u(u({},Object(i.b)("config",["GetConfig"])),Object(i.b)("user",["GetUser"])),Object(i.b)("navigation",["Generate"])),Object(i.b)("common",["Custom"])),{},{findActualValue:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"uuid";return t.find((function(t){return t[s]===e}))||null},submit:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(formUtil.isUnchanged(this.initialFormData,this.formData))return this.$toasted.info(this.$t("general.nothing_changed"),this.$toastConfig.info),!1;this.isLoading=!0,this.formData.hasOwnProperty("type")&&(this.formData.type=this.formData.type.snakeCase());var s=!0===t||this.useUserPreference?r.e:"module"===this.configType?r.d:r.c;"function"==typeof this.beforeSubmit&&this.beforeSubmit(),s(this.formData).then((function(s){(!0===t||e.useUserPreference?e.GetUser:e.GetConfig)().then((function(){e.$toasted.success(s.message,e.$toastConfig),e.initialFormData=_.cloneDeep(e.formData),e.isLoading=!1})).catch((function(t){e.isLoading=!1,e.formErrors=formUtil.handleErrors(t)})),"function"==typeof e.afterSubmit&&e.afterSubmit(),"function"==typeof e.afterSubmitSuccess&&e.afterSubmitSuccess()})).catch((function(t){e.isLoading=!1,e.formErrors=formUtil.handleErrors(t),"function"==typeof e.afterSubmit&&e.afterSubmit(),"function"==typeof e.afterSubmitError&&e.afterSubmitError()}))},reset:function(){var e=this;formUtil.confirmAction().then((function(t){t.value&&(e.formData=Object.assign({},e.formData,_.cloneDeep(e.initialFormData)))}))},unsavedCheck:function(e){formUtil.unsavedCheckAlert(this.initialFormData,this.formData,e)},fillPreRequisite:function(e){var t=this;this.preRequisite.objForEach((function(s,o){t.preRequisite[o]=e.hasOwnProperty(o)?e[o]:s})),this.isLoading=!1},fillFormData:function(){var e=this;this.isLoading=!0;var t=this.useUserPreference?this.configsWithPreference:this.configs;this.formData.type&&t[this.formData.type]&&(this.formData=formUtil.assignValues(this.formData,t[this.formData.type])),this.formData.types&&Array.isArray(this.formData.types)&&this.formData.types.forEach((function(s){e.formData=formUtil.assignValues(e.formData,t[s])})),this.formData.override&&this.formData.objForEach((function(s,o){s&&_.isObject(s)?e.formData[o]=formUtil.assignValues(e.formData[o],t[o]):e.formData[o]=t[o]?t[o]:s})),"function"==typeof this.addNewRow&&"function"==typeof this.addNewRowIfNone&&this.addNewRowIfNone(),this.isLoading=!1},getInitialData:function(e){var t,s=this;return(t=a.a.mark((function t(){var o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s.isLoading=!0,t.prev=1,t.next=4,r.b(Object.keys(s.preRequisite).join(","));case 4:return o=t.sent,s.fillPreRequisite(o),e&&s.$nextTick((function(){e()})),t.abrupt("return",o);case 10:throw t.prev=10,t.t0=t.catch(1),s.isLoading=!1,s.formErrors=formUtil.handleErrors(t.t0),t.t0;case 15:case"end":return t.stop()}}),t,null,[[1,10]])})),function(){var e=this,s=arguments;return new Promise((function(o,a){var i=t.apply(e,s);function r(e){n(i,o,a,r,c,"next",e)}function c(e){n(i,o,a,r,c,"throw",e)}r(void 0)}))})()}}),mounted:function(){this.fillFormData(),this.initialFormData=_.cloneDeep(this.formData)},beforeDestroy:function(){delete this.formData,delete this.formErrors,delete this.preRequisite},beforeRouteLeave:function(e,t,s){this.unsavedCheck(s)}}},"4eoG":function(e,t,s){"use strict";s("yufk")},"8Cr2":function(e,t,s){(t=e.exports=s("I1BE")(!1)).push([e.i,"@import url(https://fonts.googleapis.com/css?family=Muli:300,400,600,700,800,900);",""]),t.push([e.i,".chatgroup-wrapper{flex-direction:column}.chatgroup-wrapper,.chatgroup-wrapper .chatgroup{display:flex;height:100%;max-height:100%;overflow:hidden}.chatgroup-wrapper .chatgroup{flex-grow:1;justify-content:stretch;align-items:stretch;position:relative;flex-direction:row}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name{display:flex;flex-direction:row;justify-content:space-between;padding:0 .85rem}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name h6{line-height:2rem;color:hsla(0,0%,100%,.8);margin-bottom:0;flex-grow:1;display:flex;justify-content:flex-start;align-items:center}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name input.form-control{background:rgba(0,0,0,.1);border-color:rgba(0,0,0,.05) transparent;border-style:solid;border-width:1px;width:100%;height:100%;color:#fff}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name input.form-control:hover{background:rgba(0,0,0,.15)}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name input.form-control:active,.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name input.form-control:focus{background:rgba(0,0,0,.35)}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name input.form-control::-moz-placeholder{color:#6c7580}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name input.form-control:-ms-input-placeholder{color:#6c7580}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name input.form-control::placeholder{color:#6c7580}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name .chatgroup-actions{display:flex;flex-direction:row;justify-content:flex-end}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name .chatgroup-actions>button{flex-grow:1;background:transparent;border:none;color:#fff;white-space:nowrap;width:40px;height:40px;border-radius:30px}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name .chatgroup-actions>button:hover{background:rgba(0,0,0,.2);padding-bottom:2px}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-members-header{border-bottom:1px solid rgba(0,0,0,.4)}.chatgroup-wrapper .chatgroup-footer{box-shadow:0 -2px 6px 0 rgba(0,0,0,.4);z-index:1;display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center}.chatgroup-wrapper .chatgroup-footer button{flex:1 0 auto;margin:0}",""])},A6gD:function(e,t,s){"use strict";var o=s("L2JU"),a=s("OjY7"),i=s("Zp8j"),r=s.n(i),n={props:{activeContainer:{type:String,default:"home",required:!0},configs:{type:Object,required:!0},fullPage:{type:Boolean,default:!1}},computed:{computedTitle:function(){return"settings"===this.activeContainer?$t("config.chat.chat_config"):"chatgroup"===this.activeContainer?$t("chat.chat_group"):$t("chat.live_chat")}}},c=s("KHd+"),u=Object(c.a)(n,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"chat-box-header"},[s("h6",{staticClass:"cb-header-title"},[e._v(e._s(e.computedTitle))]),e._v(" "),s("div",{staticClass:"cb-header-buttons action-buttons"},["chatgroup"===e.activeContainer?[s("button",{attrs:{type:"button"},on:{click:function(t){return e.$emit("goBack")}}},[s("i",{class:["fas",{"fa-chevron-left":"chatgroup"===e.activeContainer}]})]),e._v(" "),s("button",{staticClass:"auto-width",attrs:{type:"button"},on:{click:function(t){return e.$emit("showAddMemberScreen")}}},[s("i",{staticClass:"fas fa-plus"}),e._v(" "),s("span",{staticClass:"px-2"},[e._v(e._s(e.$t("chat.add")))])])]:["home"!==e.activeContainer?s("button",{attrs:{type:"button"},on:{click:function(t){return e.$emit("goHome")}}},[s("i",{class:["fas",{"fa-chevron-left":"conversation"===e.activeContainer},{"fa-chevron-right":"settings"===e.activeContainer}]})]):e._e(),e._v(" "),"settings"!==e.activeContainer?[s("button",{attrs:{type:"button"},on:{click:function(t){return e.$emit("toggleSearch")}}},[s("i",{staticClass:"fas fa-search"})]),e._v(" "),s("button",{attrs:{type:"button"},on:{click:function(t){return e.$emit("goToSettings")}}},[s("i",{staticClass:"fas fa-cog"})])]:e._e(),e._v(" "),"home"===e.activeContainer&&!e.fullPage&&e.configs.chat.seaparateWindow?s("router-link",{staticClass:"button",attrs:{to:{name:"appChat"}}},[s("i",{staticClass:"fas fa-external-link-alt"})]):e._e()],e._v(" "),e.fullPage?e._e():s("button",{attrs:{type:"button"},on:{click:function(t){return e.$emit("hideChatBox")}}},[s("i",{staticClass:"fas fa-times"})])],2)])}),[],!1,null,null,null).exports,m={extends:s("3HR4").a,props:{activeContainer:{type:String,default:"home",required:!0}},watch:{activeContainer:function(e,t){"settings"===e&&e!==t&&(this.formData=Object.assign({},this.formData,_.cloneDeep(this.initialFormData)))}},data:function(){return{now:moment(),formData:{chat:{enableAutoOpen:!1,enterToSubmit:!1,muteSoundNotification:!1},override:!0},useUserPreference:!0}},methods:{afterSubmitSuccess:function(){this.$emit("goHome")}}},h=(s("4eoG"),Object(c.a)(m,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"cb-inner-window settings-container"},["settings"===e.activeContainer?s("div",{staticClass:"settings-wrapper"},[s("div",{staticClass:"settings"},[s("vue-scroll",{ref:"vue-scroll-settings",attrs:{id:"vue-scroll-settings"}},[s("div",{staticClass:"settings-list"},[s("switch-wrapper",{staticClass:"text-light",attrs:{label:e.$t("config.chat.enable_auto_open")}},[s("base-switch",{attrs:{design:"success"},model:{value:e.formData.chat.enableAutoOpen,callback:function(t){e.$set(e.formData.chat,"enableAutoOpen",t)},expression:"formData.chat.enableAutoOpen"}})],1),e._v(" "),s("switch-wrapper",{staticClass:"text-light",attrs:{label:e.$t("config.chat.enter_to_submit")}},[s("base-switch",{attrs:{design:"success"},model:{value:e.formData.chat.enterToSubmit,callback:function(t){e.$set(e.formData.chat,"enterToSubmit",t)},expression:"formData.chat.enterToSubmit"}})],1),e._v(" "),s("switch-wrapper",{staticClass:"text-light",attrs:{label:e.$t("config.chat.mute_sound_notification")}},[s("base-switch",{attrs:{design:"success"},model:{value:e.formData.chat.muteSoundNotification,callback:function(t){e.$set(e.formData.chat,"muteSoundNotification",t)},expression:"formData.chat.muteSoundNotification"}})],1)],1)])],1),e._v(" "),s("div",{staticClass:"settings-footer"},[s("base-button",{attrs:{type:"button",design:"primary",size:"block"},on:{click:e.submit}},[e._v(e._s(e.$t("general.save")))])],1)]):e._e()])}),[],!1,null,null,null).exports);function l(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function d(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l(Object(s),!0).forEach((function(t){f(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function f(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var p={props:{activeContainer:{type:String,default:"home",required:!0},activeGroup:{type:[Object,null],default:function(){return null}},membersToAdd:{type:Array,default:function(){return[]}},membersToRemove:{type:Array,default:function(){return[]}}},data:function(){return{formData:{uuid:null,name:"",isPublicGroup:!1,members:[]},showEditNameForm:!1,isLoading:!1}},watch:{activeContainer:function(e,t){"chatgroup"===e&&e!==t&&(this.activeGroup||(this.formData.uuid=null,this.formData.name="",this.formData.isPublicGroup=!1,this.formData.members=[]))},activeGroup:function(e,t){t!==e&&(e?(this.formData.uuid=e.uuid,this.formData.name=e.name,this.formData.members=e.members,this.getMembers()):(this.formData.uuid=null,this.formData.name="",this.formData.isPublicGroup=!1,this.formData.members=[]))},membersToAdd:{handler:function(e){var t=this;e&&e.length&&e.forEach((function(e){-1===t.formData.members.findIndex((function(t){return t.user.uuid===e.user.uuid}))&&t.formData.members.push(d({},e))}))},deep:!0},membersToRemove:{handler:function(e){var t=this;e&&e.length&&e.forEach((function(e){var s=t.formData.members.findIndex((function(t){return t.user.uuid===e.user.uuid}));-1!==s&&t.formData.members.splice(s,1)}))},deep:!0}},computed:d({},Object(o.c)("user",["hasRole"])),methods:d(d({},Object(o.b)("chat",["CreateRoom","UpdateRoom","GetRoomMembers"])),{},{goBack:function(){this.formData.uuid=null,this.formData.name="",this.formData.isPublicGroup=!1,this.formData.members=[],this.$emit("goBack")},editName:function(){this.showEditNameForm=!0},updateName:function(){var e=this;this.isLoading=!0,this.UpdateRoom({uuid:this.formData.uuid,name:this.formData.name}).then((function(t){e.isLoading=!1,e.showEditNameForm=!1})).catch((function(t){e.isLoading=!1,formUtil.handleErrors(t)}))},createGroup:function(){var e=this;this.isLoading=!0,this.CreateRoom({name:this.formData.name,isPublicGroup:this.formData.isPublicGroup,members:this.formData.members.map((function(e){return e.user}))}).then((function(t){e.isLoading=!1,e.$emit("goToConversation",{room:t,user:null})})).catch((function(t){e.isLoading=!1,formUtil.handleErrors(t)}))},getMembers:function(){var e=this;this.activeGroup&&(this.isLoading=!0,this.GetRoomMembers({uuid:this.activeGroup.uuid}).then((function(t){e.isLoading=!1,e.formData.members=t})).catch((function(t){e.isLoading=!1,formUtil.handleErrors(t)})))}}),mounted:function(){this.activeGroup&&this.getMembers()}},g=(s("aWil"),Object(c.a)(p,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"cb-inner-window chatgroup-container"},["chatgroup"===e.activeContainer?s("div",{staticClass:"chatgroup-wrapper"},[s("div",{staticClass:"chatgroup"},[s("vue-scroll",{ref:"vue-scroll-chatgroup",attrs:{id:"vue-scroll-chatgroup"}},[s("div",{staticClass:"chatgroup-form"},[e.activeGroup?[e.showEditNameForm?e.activeGroup.canModerate?s("div",{staticClass:"chatgroup-name mt-2"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.name,expression:"formData.name"}],ref:"groupName",staticClass:"form-control",attrs:{type:"text",placeholder:e.$t("chat.chat_group_name")},domProps:{value:e.formData.name},on:{input:function(t){t.target.composing||e.$set(e.formData,"name",t.target.value)}}}),e._v(" "),s("div",{staticClass:"chatgroup-actions"},[s("button",{attrs:{type:"button"},on:{click:e.updateName}},[s("i",{staticClass:"fas fa-check"})])])]):e._e():s("div",{staticClass:"chatgroup-name mt-2"},[s("h6",[e._v(e._s(e.formData.name))]),e._v(" "),e.activeGroup.canModerate?s("div",{staticClass:"chatgroup-actions"},[s("button",{attrs:{type:"button"},on:{click:e.editName}},[s("i",{staticClass:"fas fa-pencil-alt"})])]):e._e()])]:[s("div",{staticClass:"chatgroup-name"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.name,expression:"formData.name"}],ref:"groupName",staticClass:"form-control",attrs:{type:"text",placeholder:e.$t("chat.chat_group_name")},domProps:{value:e.formData.name},on:{input:function(t){t.target.composing||e.$set(e.formData,"name",t.target.value)}}})]),e._v(" "),e.hasRole("admin")?s("base-checkbox",{staticClass:"ml-3 mt-4",model:{value:e.formData.isPublicGroup,callback:function(t){e.$set(e.formData,"isPublicGroup",t)},expression:"formData.isPublicGroup"}},[s("span",{staticClass:"text-light"},[e._v(e._s(e.$t("chat.is_public_group"))+"?")])]):e._e()],e._v(" "),s("div",{staticClass:"chatgroup-members-header pt-3"}),e._v(" "),s("div",{staticClass:"chatgroup-members"},[e._t("members",null,{members:e.formData.members})],2)],2)])],1),e._v(" "),e.activeGroup?e._e():s("div",{staticClass:"chatgroup-footer"},[s("base-button",{attrs:{type:"button",design:"dark-primary"},on:{click:e.goBack}},[e._v(e._s(e.$t("general.cancel")))]),e._v(" "),s("base-button",{attrs:{type:"button",design:"primary"},on:{click:e.createGroup}},[e._v(e._s(e.$t("general.save")))])],1)]):e._e()])}),[],!1,null,null,null).exports);function v(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function b(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?v(Object(s),!0).forEach((function(t){C(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):v(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function C(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var w={props:{room:{type:Object,required:!0},roomName:{type:String,required:!0},showLastMessage:{type:Boolean,default:!0},clickAction:{type:String,default:"goToConversation"},showCustomAction:{type:Boolean,default:!1},clickActionOnCustom:{type:String,default:"removeMember"},customActionIcon:{type:String,default:"fas fa-times"},vars:{type:Object,default:function(){return{}}}},computed:b(b({},Object(o.c)("user",{userUuid:"uuid"})),{},{computedAvatar:function(){return this.room.isGroup||!this.room.member?this.room:this.room.member}}),methods:{onClickRoomItem:function(){this.computedAvatar.uuid!==this.userUuid&&("addToGroup"===this.clickAction?this.$emit(this.clickAction,{room:null,user:this.room.member?this.room.member:this.room}):this.room.isGroup||this.room.member?this.$emit(this.clickAction,{room:this.room,user:null}):this.$emit(this.clickAction,{room:null,user:this.room}))},doCustomAction:function(){this.$emit(this.clickActionOnCustom,{room:this.room,user:this.room.member?this.room.member:this.room})}}},y=Object(c.a)(w,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("li",{class:["room-item"],on:{click:e.onClickRoomItem}},[s("div",{staticClass:"item-thumb"},[s("user-avatar",{attrs:{user:e.computedAvatar,size:40}})],1),e._v(" "),s("div",{staticClass:"item-details"},[s("div",{staticClass:"title-row"},[s("h6",{staticClass:"item-title"},[e._v(e._s(e.roomName))]),e._v(" "),e.showLastMessage&&e.room.lastConversationAt?s("small",{staticClass:"item-meta"},[e._v(e._s(e._f("momentCalendarTz")(e.room.lastConversationAt)))]):e._e()]),e._v(" "),e.showLastMessage&&e.room.lastConversationAt?[e.room.message?s("div",{staticClass:"meta-row text-ellipsis"},["%%chat_attachment_%%"===e.room.message?s("span",[e._v(e._s(e.$t("upload.attachment")))]):s("span",{domProps:{innerHTML:e._s(e.room.message)}})]):e.room.isGroup?s("div",{staticClass:"meta-row text-ellipsis"},[s("span",[e._v(e._s(e.room.memberCount)+" "+e._s(e.$t("chat.members")))])]):e._e()]:e._e(),e._v(" "),e.room.unreadMessages?s("div",{staticClass:"unread-messages"},[s("span",{staticClass:"badge badge-sm badge-pill badge-light"},[e._v(e._s(e.room.unreadMessages))])]):e._e()],2),e._v(" "),e._t("actions",[e.showCustomAction?s("div",{staticClass:"item-actions action-buttons floating-action-buttons"},[s("button",{attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),e.doCustomAction(t)}}},[s("i",{class:e.customActionIcon})])]):e._e()])],2)}),[],!1,null,null,null).exports;function T(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function S(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?T(Object(s),!0).forEach((function(t){O(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):T(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function O(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var R={props:{room:{type:Object,required:!0},roomName:{type:String,required:!0},vars:{type:Object,required:!0},configs:{type:Object,required:!0},typingUser:{type:String}},computed:S(S({},Object(o.c)("user",["liveUsers"])),{},{computedUser:function(){return this.room.isGroup||!this.room.member?this.room:this.room.member},roomMembers:function(){return this.room.memberCount<=1?this.$t("chat.only_you_are_member"):this.room.members&&this.room.members.length>1?this.room.members[1].user.profile.name+this.$t("chat.and_n_other_members",{attribute:this.room.memberCount-1}):""}}),methods:{isLiveOnline:function(e){return!(!e||!this.liveUsers.find((function(t){return t.uuid===e.uuid})))},goToGroup:function(){this.$emit("goToGroup",this.room)}}},M=Object(c.a)(R,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"conversation-header"},[s("div",{staticClass:"room-thumb"},[s("user-avatar",{attrs:{user:e.computedUser,size:40}})],1),e._v(" "),s("div",{staticClass:"room-details"},[s("div",{staticClass:"title-row"},[s("h6",{staticClass:"room-title"},[e._v(e._s(e.roomName))])]),e._v(" "),s("div",{staticClass:"meta-row"},[e.room.isGroup||e.typingUser?e.room.isGroup?[e.typingUser?[s("span",{staticClass:"typing-indicator"},[e._v(e._s(e.typingUser)+" "+e._s(e.$t("general.is_typing")))]),e._v(" "),s("span",[e._v("  ")])]:e.roomMembers?s("span",[e._v(e._s(e.roomMembers))]):s("span",[e._v(e._s(e.room.memberCount)+" "+e._s(e.$t("chat.members")))])]:[s("span",{directives:[{name:"show",rawName:"v-show",value:e.typingUser,expression:"typingUser"}],staticClass:"typing-indicator"},[e._v(e._s(e.$t("general.is_typing")))]),e._v(" "),s("span",[e._v("  ")])]:[e.isLiveOnline(e.computedUser)?s("span",[e._v(e._s(e.$t("general.online")))]):s("span",[e._v(e._s(e.$t("general.offline")))])]],2)]),e._v(" "),s("div",{staticClass:"room-btns action-buttons"},[e.room.isGroup&&!e.room.hasLeft&&e.configs.chat.groupChat?s("button",{attrs:{type:"button"},on:{click:e.goToGroup}},[s("i",{staticClass:"fas fa-info-circle"})]):e._e()])])}),[],!1,null,null,null).exports,x={props:{message:{type:Object,required:!0},fileIcons:{type:Object,required:!0},fileMimeTypes:{type:Object,required:!0},vars:{type:Object,default:function(){return{}}}},data:function(){return{messageStatusIcons:{sending:"far fa-clock",sent:"fas fa-check",delivered:"fas fa-check-double",read:"fas fa-check-double",error:"fas fa-exclamation-triangle"}}},computed:{hasAttachment:function(){return(!this.message.message||"%%chat_attachment_%%"===this.message.message)&&this.message.attachments&&this.message.attachments.length}}},j=Object(c.a)(x,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message-item-wrapper"},[s("div",{class:["message-item",{"has-attachments":e.hasAttachment}]},[s("span",{staticClass:"tail-in"},[s("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 8 13",width:"8",height:"13"}},[s("path",{attrs:{opacity:".13",fill:"#0000000",d:"M1.533 3.568L8 12.193V1H2.812C1.042 1 .474 2.156 1.533 3.568z"}}),s("path",{attrs:{fill:"currentColor",d:"M1.533 2.568L8 11.193V0H2.812C1.042 0 .474 1.156 1.533 2.568z"}})])]),e._v(" "),s("div",{staticClass:"message-header"},[s("h6",{staticClass:"message-user"},[e._v(e._s(e.message.user.profile.name))])]),e._v(" "),e.hasAttachment?s("div",{staticClass:"message-content"},[e._l(e.message.attachments,(function(t){return[s("div",{key:t.uuid,class:["attachment",{"non-image-attachment":"image/png"!==t.mime&&"image/jpeg"!==t.mime}]},["image/png"===t.mime||"image/jpeg"===t.mime?[s("a",{staticClass:"attachment-link",attrs:{href:t.fullUrl,target:"_blank"}},[s("img",{staticClass:"img-fluid",attrs:{src:t.fullUrl,alt:t.filename}})]),e._v(" "),s("div",{staticClass:"attachment-shadow"}),e._v(" "),s("div",{staticClass:"message-footer small"},[e.message.sentAt?s("span",{staticClass:"message-created-at"},[e._v(e._s(e._f("momentCalendarTz")(e.message.sentAt)))]):e._e(),e._v(" "),s("span",{class:["message-status",e.message.status]},[s("i",{class:e.messageStatusIcons[e.message.status]})])])]:[s("a",{staticClass:"attachment-link",attrs:{href:t.fullUrl,target:"_blank"}},[s("div",{staticClass:"attachment-details"},[s("div",{staticClass:"attachment-icon"},[s("i",{class:["fas",e.fileIcons[t.mime]]})]),e._v(" "),s("div",{staticClass:"attachment-name"},[s("h6",[e._v(e._s(t.filename))])]),e._v(" "),e._m(0,!0)])]),e._v(" "),s("div",{staticClass:"message-footer small"},[s("div",{staticClass:"left-side"},[s("span",{staticClass:"attachment-type"},[e._v(e._s(e.fileMimeTypes[t.mime]))]),s("span",{staticClass:"attachment-size"},[e._v(e._s(t.humanReadableSize))])]),e._v(" "),s("div",{staticClass:"right-side"},[e.message.sentAt?s("span",{staticClass:"message-created-at"},[e._v(e._s(e._f("momentCalendarTz")(e.message.sentAt)))]):e._e(),e._v(" "),s("span",{class:["message-status",e.message.status]},[s("i",{class:e.messageStatusIcons[e.message.status]})])])])]],2)]}))],2):s("div",{staticClass:"message-content"},[s("div",{staticClass:"message-body"},[s("div",{staticClass:"message",domProps:{innerHTML:e._s(e.message.message)}}),e._v(" "),s("div",{staticClass:"footer-space"})]),e._v(" "),s("div",{staticClass:"message-footer small"},[e.message.sentAt?s("span",{staticClass:"message-created-at"},[e._v(e._s(e._f("momentCalendarTz")(e.message.sentAt)))]):e._e(),e._v(" "),s("span",{class:["message-status",e.message.status]},[s("i",{class:e.messageStatusIcons[e.message.status]})])])])])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"download-icon"},[t("i",{staticClass:"far fa-arrow-alt-circle-down"})])}],!1,null,null,null).exports,k=s("ofXV"),D=s.n(k),U=s("BcCH"),P=s("PCDP"),E=s("i8R7"),G=s("nFxi");s("akQX");function $(e){return function(e){if(Array.isArray(e))return A(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return A(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,o=new Array(t);s<t;s++)o[s]=e[s];return o}function L(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function F(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?L(Object(s),!0).forEach((function(t){B(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):L(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function B(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var I={name:"ChatBox",components:{FileUploader:a.a,EmojiPicker:r.a,At:D.a,ChatBoxHeader:u,ChatBoxSettings:h,ChatBoxGroup:g,ChatRoomItem:y,ConversationHeader:M,MessageItem:j},props:{channel:{default:null},boxVisibility:{type:Boolean,default:!1},fullPage:{type:Boolean,default:!1},meeting:{type:Object,default:function(){return{}}}},data:function(){return{isBoxShown:!1,isSearchShown:!1,showChatOptions:!1,largeChatBox:!1,searched:!1,newChatScreen:!1,newGroupScreen:!1,cbHeaderTitle:$t("chat.live_chat"),searchTerm:"",searchTermEmoji:"",activeContainer:"home",members:[],newMessage:{message:"",attachments:[],updated:!1},newMessageRequestUUID:uuid(),activeConversation:null,activeGroup:null,activeGroupMembersToAdd:[],activeGroupMembersToRemove:[],uploadURL:"",formErrors:{},preRequisite:{uploaderConfig:{module:"",token:"",allowedExtensions:"",maxNoOfFiles:1,uuid:uuid()}},goingToConversation:!1,isFetching:!1,noMoreMessages:!1,newUnreadMessageOnFeed:!1,showScrollToLatestBtn:!1,chatRoomChannel:null,typingUser:null,typingUserTimeout:null,initialNewMessage:null,firstFetch:!0,fileIcons:G.b,fileMimeTypes:G.c}},watch:{boxVisibility:function(e,t){this.isBoxShown=e,this.isBoxShown&&document.body.classList.add("chat-box-shown")},activeChatUser:function(e,t){null===e||t&&(null===t||e.uuid===t.uuid)||this.goToConversation({user:e})},activeChatRoom:function(e,t){!1!==this.goingToConversation||null===e||t&&(null===t||e.uuid===t.uuid)||this.goToConversation({room:e})}},computed:F(F(F(F(F({},Object(o.c)("config",["vars","configs","uiConfigs"])),Object(o.c)("user",{userUuid:"uuid"})),Object(o.c)("user",["profile","username"])),Object(o.c)("chat",["rooms","roomsPageMeta","roomsSearch","messages","messagesPageMeta","messagesSearch","activeChatRoom","activeChatUser"])),{},{user:function(){return{uuid:this.userUuid,username:this.username,name:this.profile.name,profile:this.profile}},hasMessages:function(){return this.activeConversation&&this.messages.data},computedParticipants:function(){return this.activeConversation?this.activeConversation.members:[]},enterToSubmit:function(){return this.configs.chat&&this.configs.chat.enterToSubmit}}),methods:F(F({},Object(o.b)("chat",["GetRooms","GetRoom","AddMemberToRoom","RemoveMemberFromRoom","SearchRooms","SearchMessages","GetMessages","SendMessage","PutMessageToFeed","PatchMessageInFeed","ResetMessage","SetMessage","ResetTotalUnreadCount","SetActiveChatRoom","SetActiveChatUser","ResetActiveChatRoomAndUser","SearchRoomMembers"])),{},{hideChatBox:function(){var e=this;this.isBoxShown=!1,this.ResetActiveChatRoomAndUser(),setTimeout((function(){e.$emit("boxHidden")}),200)},showChatBox:function(){this.isBoxShown=!0,this.$emit("boxShown")},hideSearch:function(){this.searchTerm="",this.searched=!1,this.isSearchShown=!1,this.showChatOptions=!0,this.newChatScreen=!1,this.newGroupScreen=!1,"home"===this.activeContainer?(this.fetchRooms(!0),this.scrollTo("vue-scroll-rooms",0)):"conversation"===this.activeContainer&&this.fetchMessages(!0)},toggleSearch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.searchTerm="",this.searched=!1,this.isSearchShown=!this.isSearchShown,this.isSearchShown?(this.newChatScreen=t,this.newGroupScreen=s,this.showChatOptions=!(t||s),this.$nextTick((function(){e.$refs.searchTerm.focus()}))):(this.newChatScreen=!1,this.newGroupScreen=!1,this.showChatOptions=!0,"home"===this.activeContainer?(this.fetchRooms(!0),this.scrollTo("vue-scroll-rooms",0)):"conversation"===this.activeContainer&&this.fetchMessages(!0))},startNewChat:function(){this.toggleSearch(!0)},goHome:function(){var e=this;this.lastActiveContainer=this.activeContainer,this.activeContainer="home",this.ResetActiveChatRoomAndUser(),"conversation"===this.lastActiveContainer?(this.leaveChatRoomChannel(this.activeConversation.chatRoom),this.hideSearch(),this.searchRoomObj&&this.searchRoomObj.searched?(this.searchTerm=this.searchRoomObj.searchTerm,this.searched=this.searchRoomObj.searched,this.isSearchShown=!0,this.showChatOptions=!1):this.fetchRooms()):this.fetchRooms(),this.scrollTo("vue-scroll-rooms",0),setTimeout((function(){e.activeConversation=null}),100)},goToConversation:function(e){var t=this,s=e.room,o=e.user;this.goingToConversation=!0;var a=function(){setTimeout((function(){t.activeContainer="conversation",t.isSearchShown?(t.searchRoomObj={searchTerm:t.searchTerm,searched:t.searched},t.hideSearch()):t.searchRoomObj={searchTerm:null,searched:null},t.goingToConversation=!1,window.setTimeout((function(){t.scrollToLatestMessages(),t.focusNewMessage(),t.showScrollToLatestBtn=!1,t.newUnreadMessageOnFeed=!1}),300)}),100)};this.activeConversation={chatRoom:s||null,user:s&&s.isGroup?null:o||null,members:s&&s.isGroup?s.members:o?[o]:[]},this.ResetMessage(),s?(s.hasLeft||this.joinChatRoomChannel(s),this.GetRoom({uuid:s.uuid}).then((function(e){var o=e.chatRoom,i=e.chats;t.activeConversation.chatRoom=o,s.hasLeft&&!o.hasLeft&&t.joinChatRoomChannel(o),o.hasLeft&&t.leaveChatRoomChannel(o),t.SetMessage({data:$(i),meta:F(F({},t.messages.meta),{},{total:i.length,lastItemUuid:i.length?i[i.length-1].uuid:null})}),t.activeConversation.chatRoom&&t.activeConversation.chatRoom.hasOwnProperty("chats")&&delete t.activeConversation.chatRoom.chats,t.noMoreMessages=!1,t.SetActiveChatRoom(t.activeConversation.chatRoom),a()})).catch((function(e){t.goingToConversation=!1,formUtil.handleErrors(e)}))):(this.SetActiveChatUser(this.activeConversation.user),this.fetchMessages(!0),a())},goToSettings:function(){var e=this;this.lastActiveContainer=this.activeContainer,this.activeContainer="settings",this.scrollTo("vue-scroll-rooms",0),setTimeout((function(){"conversation"===e.lastActiveContainer&&(e.ResetActiveChatRoomAndUser(),e.leaveChatRoomChannel(e.activeConversation.chatRoom)),e.isSearchShown&&e.hideSearch(),e.activeConversation=null}),100)},goToCreateGroup:function(){this.activeGroup=null,this.goToGroup()},goToGroup:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.activeGroupMembersToAdd=[],this.activeGroupMembersToRemove=[],this.lastActiveContainer=this.activeContainer,this.activeContainer="chatgroup",this.activeGroup=t,this.scrollTo("vue-scroll-rooms",0),this.isSearchShown&&this.hideSearch(),t||this.$nextTick((function(){window.setTimeout((function(){e.$refs.chatBoxGroup.$refs.groupName.focus()}),300)}))},showAddMemberScreen:function(){this.activeGroupMembersToAdd=[],this.activeGroupMembersToRemove=[],this.toggleSearch(!1,!0)},addToGroup:function(e){var t=this;e&&e.user&&(this.activeGroup?(this.isLoading=!0,this.AddMemberToRoom({uuid:this.activeGroup.uuid,members:[e.user]}).then((function(e){t.isLoading=!1,t.activeGroup=e,t.activeConversation.chatRoom=e,t.activeConversation.chatRoom.members=e.members})).catch((function(e){t.isLoading=!1,formUtil.handleErrors(e)}))):this.activeGroupMembersToAdd.push(e)),this.toggleSearch()},removeMemberFromGroup:function(e){var t=this;this.activeGroupMembersToAdd=[],this.activeGroupMembersToRemove=[],e&&e.user&&(this.activeGroup?(this.isLoading=!0,this.RemoveMemberFromRoom({uuid:this.activeGroup.uuid,members:[e.user]}).then((function(e){t.isLoading=!1,t.activeGroup=e,t.activeConversation.chatRoom=e})).catch((function(e){t.isLoading=!1,formUtil.handleErrors(e)}))):this.activeGroupMembersToRemove.push(e))},goBack:function(){this.lastActiveContainer?this.activeContainer=this.lastActiveContainer:this.goHome()},searchTermChanged:_.debounce((function(){!this.searchTerm||this.searchTerm.length<2||("home"===this.activeContainer||"chatgroup"===this.activeContainer?(this.searchRooms(),this.scrollTo("vue-scroll-rooms",0)):"conversation"===this.activeContainer&&this.searchMessages())}),500),handleAt:function(e){var t=this;!e||e.length<2?this.activeConversation&&(this.activeConversation.members=[]):this.activeConversation.chatRoom?this.SearchRoomMembers({uuid:this.activeConversation.chatRoom.uuid,term:e}).then((function(e){t.activeConversation.members=e})).catch((function(e){formUtil.handleErrors(e),t.activeConversation&&(t.activeConversation.members=[])})):this.activeConversation.members=[]},fetchRooms:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isFetching=!0;var s=F(F({},this.roomsPageMeta),{},{lastItemUuid:t?null:this.rooms.meta.lastItemUuid,perPage:this.rooms.meta.perPage});this.GetRooms(s).then((function(t){e.isFetching=!1})).catch((function(t){e.isFetching=!1,formUtil.handleErrors(t)}))},searchRooms:function(){var e=this;this.isFetching=!0,this.SearchRooms(this.searchTerm).then((function(t){e.searched=!0,e.showChatOptions=!1,e.isFetching=!1})).catch((function(t){e.isFetching=!1,formUtil.handleErrors(t)}))},searchMessages:function(){var e=this;this.activeConversation.chatRoom&&(this.isFetching=!0,this.SearchMessages({q:this.searchTerm,chatRoom:this.activeConversation.chatRoom.uuid}).then((function(t){e.searched=!0,e.isFetching=!1,window.setTimeout((function(){e.scrollToLatestMessages(),e.showScrollToLatestBtn=!1,e.newUnreadMessageOnFeed=!1}),300)})).catch((function(t){e.isFetching=!1,formUtil.handleErrors(t)})))},fetchMessages:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.activeConversation.chatRoom||this.activeConversation.user){this.isFetching=!0,this.noMoreMessages=!1,this.newUnreadMessageOnFeed=!1;var s=F(F({},this.messagesPageMeta),{},{lastItemUuid:t?null:this.messages.meta.lastItemUuid,perPage:this.messages.meta.perPage,chatRoom:this.activeConversation.chatRoom?this.activeConversation.chatRoom.uuid:null,user:this.activeConversation.user?this.activeConversation.user.uuid:null});this.GetMessages(s).then((function(s){e.isFetching=!1,s.data.length||(e.noMoreMessages=!0),t&&window.setTimeout((function(){e.scrollToLatestMessages(),e.showScrollToLatestBtn=!1,e.newUnreadMessageOnFeed=!1}),300),e.searched||e.focusNewMessage()})).catch((function(t){e.isFetching=!1,formUtil.handleErrors(t)}))}},chatRoomUpdated:function(){var e=this;this.GetRoom({uuid:this.activeConversation.chatRoom.uuid}).then((function(t){var s=t.chatRoom;e.activeConversation.chatRoom=s,t.hasLeft&&e.leaveChatRoomChannel(s)})).catch((function(e){formUtil.handleErrors(e)}))},postMessage:function(){var e=this;if(this.newMessage.message){this.newMessage.message=this.newMessage.message.trim();var t={uuid:this.newMessageRequestUUID,message:this.newMessage.message,user:this.user,sentAt:moment().format(this.vars.serverDateTimeFormat),status:"sending"};this.newMessageRequestUUID=uuid(),this.newMessage=_.cloneDeep(this.initialNewMessage),this.noMoreMessages=!1,this.putMessageToFeed(t),window.setTimeout((function(){e.scrollTo("vue-scroll-messages",100),e.focusNewMessage()}),300),this.SendMessage({message:t.message,chatRoom:this.activeConversation.chatRoom,user:this.activeConversation.user}).then((function(s){e.messageSentSuccess(t,s)})).catch((function(s){e.messageSendingFailed(t,s)}))}},attachmentUploadStarted:function(e){var t=this;if(this.newMessage.attachments&&!this.newMessage.attachments.length){var s={uuid:this.newMessageRequestUUID,message:null,user:this.user,sentAt:moment().format(this.vars.serverDateTimeFormat),status:"sending"};this.newMessageRequestUUID=uuid(),this.newMessage=_.cloneDeep(this.initialNewMessage),this.putMessageToFeed(s),window.setTimeout((function(){t.scrollTo("vue-scroll-messages",100),t.focusNewMessage()}),300)}},attachmentUploaded:function(e){U.a.$emit("RESET_UPLOAD"),this.messageSentSuccess({uuid:e.meta.requestUuid},e)},attachmentUploadError:function(e){U.a.$emit("RESET_UPLOAD"),e&&this.messageSendingFailed({uuid:response.meta.requestUuid},e)},messageSentSuccess:function(e,t){var s=this,o=t.data;this.PatchMessageInFeed({old:e,new:F(F({},o),{},{newUuid:o.uuid,uuid:e.uuid})}),this.activeConversation.chatRoom||(this.joinChatRoomChannel(o.chatRoom),this.GetRoom({uuid:o.chatRoom.uuid}).then((function(e){s.activeConversation.chatRoom=e.chatRoom,s.activeConversation.chatRoom&&s.activeConversation.chatRoom.hasOwnProperty("chats")&&delete s.activeConversation.chatRoom.chats})).catch((function(e){formUtil.handleErrors(e)})))},messageSendingFailed:function(e,t){this.PatchMessageInFeed({old:e,new:F(F({},e),{},{status:"error",error:formUtil.getError(t)})})},noNeedCallback:function(){this.afterUploadComplete()},joinChatRoomChannel:function(e){window.EchoOpts.subscriptions.chatRoom=window.Echo.join("ChatRoom.".concat(e.uuid)),this.chatRoomChannel=window.EchoOpts.subscriptions.chatRoom,this.chatRoomChannel.listen("ChatMessageSentToRoom",this.newMessageReceived),this.chatRoomChannel.listen("ChatRoomUpdated",this.chatRoomUpdated),this.chatRoomChannel.listenForWhisper("typing",this.anotherUserTyping)},leaveChatRoomChannel:function(e){this.chatRoomChannel&&(this.chatRoomChannel.stopListening("ChatMessageSentToRoom"),this.chatRoomChannel=null),e&&window.Echo.leave("ChatRoom.".concat(e.uuid)),window.EchoOpts&&window.EchoOpts.subscriptions&&(window.EchoOpts.subscriptions.chatRoom=null)},enterPressedEvt:function(e,t){return!!this.enterToSubmit&&Object(P.enterPressed)(e,t)},putMessageToFeed:function(e){-1===this.messages.data.findIndex((function(t){return t.uuid===e.uuid}))&&this.PutMessageToFeed(e)},focusNewMessage:function(){this.$refs.newMessageInput&&this.$refs.newMessageInput.focus()},scrollTo:function(e,t){this.$refs[e]&&this.$refs[e].scrollTo({y:"".concat(t,"%")},300)},scrollToLatestMessages:function(){this.scrollTo("vue-scroll-messages",100)},handleMessageScroll:_.debounce((function(e,t){e.process>.95?(this.showScrollToLatestBtn=!1,this.newUnreadMessageOnFeed=!1):(!this.searched||this.searched&&0!==e.process)&&(this.showScrollToLatestBtn=!0),e.process<.5&&!this.isFetching&&!this.noMoreMessages&&this.fetchMessages()}),500),handleRoomsScroll:_.debounce((function(e,t){e.process>.5&&!this.isFetching&&this.fetchRooms()}),500),isTyping:_.throttle((function(){this.chatRoomChannel&&this.chatRoomChannel.whisper("typing",{user:this.user})}),500,{leading:!0,trailing:!1}),anotherUserTyping:function(e){var t=this,s=e.user;this.typingUser=s.name,this.typingUserTimeout&&clearTimeout(this.typingUserTimeout),this.typingUserTimeout=setTimeout((function(){t.typingUser=null}),1500)},newMessageReceived:function(e){var t=this;e&&(e=Object(E.b)(e))&&e.user&&e.user.uuid!==this.userUuid&&(this.putMessageToFeed(e),window.setTimeout((function(){var e=t.$refs["vue-scroll-messages"].getScrollProcess(),s=e.v;e.h;s>.5?t.scrollToLatestMessages():(t.showScrollToLatestBtn=!0,t.newUnreadMessageOnFeed=!0)}),300))},appendEmoji:function(e){this.newMessage.message+=e},doInit:function(){var e=this;this.initialNewMessage=_.cloneDeep(this.newMessage),this.activeChatRoom?this.goToConversation({room:this.activeChatRoom}):this.activeChatUser?this.goToConversation({user:this.activeChatUser}):this.fetchRooms(),this.isBoxShown&&document.body.classList.add("chat-box-shown"),setTimeout((function(){e.showChatOptions=e.boxVisibility}),1e3)}}),directives:{focus:{inserted:function(e){e.focus()}}},mounted:function(){var e=this;setTimeout((function(){e.isBoxShown=e.boxVisibility}),100),setTimeout((function(){e.doInit()}),200)},created:function(){},beforeDestroy:function(){document.body.classList.remove("chat-box-shown"),window.Echo&&window.EchoOpts&&window.EchoOpts.subscriptions&&window.EchoOpts.subscriptions.chatRoom&&(window.EchoOpts.subscriptions.chatRoom.stopListening("ChatMessageSentToRoom"),window.EchoOpts.subscriptions.chatRoom=null)}},N=Object(c.a)(I,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["chat-box-wrapper",{shown:e.isBoxShown},{"search-shown":e.isSearchShown},{"chat-box-lg":e.largeChatBox},{"show-chat-options":e.showChatOptions}]},[s("chat-box-header",{attrs:{"active-container":e.activeContainer,configs:e.configs,"full-page":e.fullPage},on:{goHome:e.goHome,toggleSearch:e.toggleSearch,goToSettings:e.goToSettings,goBack:e.goBack,hideChatBox:e.hideChatBox,showAddMemberScreen:e.showAddMemberScreen}}),e._v(" "),s("div",{staticClass:"search"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchTerm,expression:"searchTerm"}],ref:"searchTerm",staticClass:"form-control",attrs:{type:"text",placeholder:e.$t("general.search_helper_default_text")},domProps:{value:e.searchTerm},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.toggleSearch(t)},input:[function(t){t.target.composing||(e.searchTerm=t.target.value)},e.searchTermChanged]}}),e._v(" "),e.searchTerm?s("button",{staticClass:"clear-btn",attrs:{type:"button"},on:{click:e.hideSearch}},[e._v(e._s(e.$t("general.clear")))]):e._e()]),e._v(" "),s("div",{class:["chat-box",{"showing-settings":"settings"===e.activeContainer},{"showing-chats":"conversation"===e.activeContainer},{"showing-chatgroup":"chatgroup"===e.activeContainer}]},[e.configs.chat.groupChat?s("chat-box-group",{ref:"chatBoxGroup",attrs:{"active-container":e.activeContainer,"active-group":e.activeGroup,"members-to-add":e.activeGroupMembersToAdd,"members-to-remove":e.activeGroupMembersToRemove},on:{goToConversation:e.goToConversation,goBack:e.goBack,goHome:e.goHome},scopedSlots:e._u([{key:"members",fn:function(t){var o=t.members;return[s("div",{staticClass:"rooms-wrapper"},[e.searchTerm&&e.searched?[e.roomsSearch.rooms.length||e.roomsSearch.users.length?s("ul",{staticClass:"rooms"},[e._l(e.roomsSearch.rooms,(function(t){return[t.isGroup?e._e():s("chat-room-item",{key:t.uuid,attrs:{room:t,"room-name":t.name,"click-action":"addToGroup",vars:e.vars,"show-last-message":!1},on:{addToGroup:e.addToGroup}})]})),e._v(" "),e._l(e.roomsSearch.users,(function(t){return s("chat-room-item",{key:t.uuid,attrs:{room:t,"room-name":t.profile.name,"click-action":"addToGroup",vars:e.vars},on:{addToGroup:e.addToGroup}})}))],2):s("div",{staticClass:"no-data"},[s("h5",[e._v(e._s(e.$t("chat.no_result_found")))])])]:[s("ul",{staticClass:"rooms"},e._l(o,(function(t){return s("chat-room-item",{key:t.user.uuid,attrs:{room:t.user,"room-name":t.user.profile.name,"click-action":"goToConversation","show-custom-action":e.activeGroup&&e.activeGroup.canModerate,"click-action-on-custom":"removeMember",vars:e.vars},on:{goToConversation:e.goToConversation,removeMember:e.removeMemberFromGroup}})})),1)]],2)]}}],null,!1,3003752676)}):e._e(),e._v(" "),s("chat-box-settings",{attrs:{"active-container":e.activeContainer},on:{goHome:e.goHome}}),e._v(" "),s("div",{staticClass:"cb-inner-window rooms-container"},[s("vue-scroll",{ref:"vue-scroll-rooms",attrs:{id:"vue-scroll-rooms"},on:{"handle-scroll":e.handleRoomsScroll}},[s("div",{staticClass:"rooms-wrapper"},[e.searchTerm&&e.searched||e.newChatScreen||e.newGroupScreen?[e.roomsSearch.rooms.length||e.roomsSearch.users.length?s("ul",{staticClass:"rooms"},[e.newChatScreen&&e.newGroupScreen?e._e():[e._l(e.roomsSearch.rooms,(function(t){return s("chat-room-item",{key:t.uuid,attrs:{room:t,"room-name":t.name,vars:e.vars},on:{goToConversation:e.goToConversation}})})),e._v(" "),e.roomsSearch.users.length?s("li",{staticClass:"my-2 pl-3 font-weight-500"},[e._v(e._s(e.$t("user.users")))]):e._e()],e._v(" "),e._l(e.roomsSearch.users,(function(t){return s("chat-room-item",{key:t.uuid,attrs:{room:t,"room-name":t.profile.name,"click-action":"goToConversation",vars:e.vars},on:{goToConversation:e.goToConversation}})}))],2):s("div",{staticClass:"no-data"},[s("h5",[e._v(e._s(e.$t("chat.no_result_found")))])])]:[e.rooms.data&&e.rooms.data.length?s("ul",{staticClass:"rooms"},e._l(e.rooms.data,(function(t){return s("chat-room-item",{key:t.uuid,attrs:{room:t,"room-name":t.name,vars:e.vars},on:{goToConversation:e.goToConversation}})})),1):s("div",{staticClass:"no-data"},[s("h5",[e._v(e._s(e.$t("chat.no_chats_yet")))])])]],2)]),e._v(" "),s("div",{staticClass:"chat-option-buttons"},[e.configs.chat.groupChat?s("button",{attrs:{type:"button"},on:{click:e.goToCreateGroup}},[s("i",{staticClass:"fas fa-users"})]):e._e(),e._v(" "),s("button",{attrs:{type:"button"},on:{click:e.startNewChat}},[s("i",{staticClass:"fas fa-user"})]),e._v(" "),e._m(0)])],1),e._v(" "),s("div",{staticClass:"cb-inner-window conversation-container"},[e.activeConversation?s("div",{staticClass:"conversation-wrapper"},[e.activeConversation.chatRoom?s("conversation-header",{attrs:{room:e.activeConversation.chatRoom,"room-name":e.activeConversation.chatRoom.name,vars:e.vars,configs:e.configs,typingUser:e.typingUser},on:{goToGroup:e.goToGroup}}):e.activeConversation.user?s("conversation-header",{attrs:{room:e.activeConversation.user,"room-name":e.activeConversation.user.profile.name,vars:e.vars,typingUser:e.typingUser}}):e._e(),e._v(" "),s("div",{class:["conversation",{"no-messages":!e.hasMessages},{"got-new-messages":e.newUnreadMessageOnFeed},{"show-scroll-btn":e.showScrollToLatestBtn}]},[e.hasMessages?s("div",{staticClass:"messages-list-container"},[s("vue-scroll",{ref:"vue-scroll-messages",attrs:{id:"vue-scroll-messages"},on:{"handle-scroll":e.handleMessageScroll}},[s("div",{class:["messages-list-wrapper",{"show-name":e.activeConversation.chatRoom&&e.activeConversation.chatRoom.isGroup}]},[e.searchTerm&&e.searched?[e.messagesSearch.length?e._l(e.messagesSearch,(function(t,o){return s("message-item",{key:t.uuid,class:[{"own-message":t.user.uuid===e.userUuid},{"prev-diff-own":!e.messages.data[o+1]||e.messages.data[o+1].user.uuid!==t.user.uuid},{"next-diff-own":!e.messages.data[o-1]||e.messages.data[o-1].user.uuid!==t.user.uuid}],attrs:{message:t,vars:e.vars,"file-icons":e.fileIcons,"file-mime-types":e.fileMimeTypes}})})):s("div",{staticClass:"no-data"},[s("h5",[e._v(e._s(e.$t("chat.no_result_found")))])])]:[e._l(e.messages.data,(function(t,o){return s("message-item",{key:t.uuid,class:[{"own-message":t.user.uuid===e.userUuid},{"prev-diff-own":!e.messages.data[o+1]||e.messages.data[o+1].user.uuid!==t.user.uuid},{"next-diff-own":!e.messages.data[o-1]||e.messages.data[o-1].user.uuid!==t.user.uuid}],attrs:{message:t,vars:e.vars,"file-icons":e.fileIcons,"file-mime-types":e.fileMimeTypes}})})),e._v(" "),e.isFetching?s("div",{staticClass:"d-flex justify-content-center my-2"},[s("animated-loader",{attrs:{"is-loading":e.isFetching,"loader-color":e.vars.colors.light,"overlay-color":"transparent",size:"inline","loader-size":"20px","loader-stroke":"3px"}})],1):e._e(),e._v(" "),e.noMoreMessages?s("div",{staticClass:"message-item my-4 d-flex justify-content-center align-items-center"},[s("h5",{staticClass:"text-muted"},[e._v("\n                                            "+e._s(e.$t("chat.no_more_messages"))+"\n                                        ")])]):e._e()]],2)])],1):s("div",{staticClass:"d-flex justify-content-center align-items-center min-height-300px"},[s("h5",{staticClass:"text-muted"},[e._v("\n                            "+e._s(e.$t("chat.no_messages_yet"))+"\n                        ")])]),e._v(" "),s("div",{staticClass:"scroll-latest-btn",on:{click:e.scrollToLatestMessages}},[e._m(1)])]),e._v(" "),e.activeConversation.chatRoom&&!e.activeConversation.chatRoom.isGroup||!e.activeConversation.chatRoom&&e.activeConversation.user||e.activeConversation.chatRoom&&e.activeConversation.chatRoom.isGroup&&!e.activeConversation.chatRoom.hasLeft?s("div",{staticClass:"conversation-footer"},[s("div",{staticClass:"new-message"},[s("at",{attrs:{members:e.computedParticipants,"name-key":"name"},on:{at:e.handleAt},scopedSlots:e._u([{key:"item",fn:function(t){return[s("span",{staticClass:"mentioned"},[e._v(e._s(t.item.name)+" "),s("span",{staticClass:"bracketed text-muted-md"},[e._v(e._s(t.item.username))])])]}},{key:"embeddedItem",fn:function(t){return[s("span",[s("span",{staticClass:"tag mentioned bg-white text-primary mx-1 px-2 py-1 rounded",attrs:{"data-uuid":t.current&&t.current.user?t.current.user.uuid:""}},[e._v(e._s(t.current.name))]),e._v(" "),s("span")])]}}],null,!1,1168386567),model:{value:e.newMessage.message,callback:function(t){e.$set(e.newMessage,"message",t)},expression:"newMessage.message"}},[e._v(" "),e._v(" "),s("div",{ref:"newMessageInput",staticClass:"new-message-input form-control",attrs:{contenteditable:"","data-placeholder":e.$t("chat.type_a_message"),placeholder:e.$t("chat.type_a_message")},on:{keydown:[e.isTyping,function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enterPressedEvt(e.postMessage,t)}]}})]),e._v(" "),s("emoji-picker",{staticClass:"emoji-picker-wrapper",attrs:{search:e.searchTermEmoji},on:{emoji:e.appendEmoji},scopedSlots:e._u([{key:"emoji-invoker",fn:function(e){var t=e.events.click;return s("button",{staticClass:"btn-custom emoji-button",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t(e)}}},[s("i",{staticClass:"far fa-grin"})])}},{key:"emoji-picker",fn:function(t){var o=t.emojis,a=t.insert;t.display;return s("div",{staticClass:"emoji-picker-container"},[s("div",{staticClass:"emoji-picker"},[s("div",{staticClass:"emoji-picker__search"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchTermEmoji,expression:"searchTermEmoji"},{name:"focus",rawName:"v-focus"}],attrs:{type:"text"},domProps:{value:e.searchTermEmoji},on:{input:function(t){t.target.composing||(e.searchTermEmoji=t.target.value)}}})]),e._v(" "),s("div",e._l(o,(function(t,o){return s("div",{key:o,staticClass:"mt-2"},[s("h5",[e._v(e._s(o))]),e._v(" "),s("div",{staticClass:"emojis"},e._l(t,(function(t,o){return s("span",{key:o,attrs:{title:o},on:{click:function(e){return a(t)}}},[e._v(e._s(t))])})),0)])})),0)])])}}],null,!1,1197881671)}),e._v(" "),!e.newMessage.message&&e.configs.chat.fileSharing?s("file-uploader",{attrs:{url:"/chat/messages","name-label":"upload.attachment","names-label":"upload.attachments","button-icon":"fas fa-paperclip","button-classes":"btn-sm","button-design":"custom","hide-button-label":"","hide-file-list":"",options:e.preRequisite.uploaderConfig,data:e.newMessage.attachments,"additional-form-data":e.activeConversation,"request-identifier":e.newMessageRequestUUID},on:{uploading:e.attachmentUploadStarted,updated:e.attachmentUploaded,error:e.attachmentUploadError,noNeed:e.noNeedCallback}}):e._e(),e._v(" "),s("button",{staticClass:"btn-custom post-message-button",attrs:{type:"button",title:e.$t("general.submit")},on:{click:e.postMessage}},[s("i",{staticClass:"far fa-paper-plane"})])],1)]):e._e()],1):e._e()])],1)],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("button",{attrs:{type:"button"}},[t("i",{staticClass:"fas fa-comment-dots fa-flip-horizontal"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"scroll-btn-wrapper"},[t("i",{staticClass:"fas fa-angle-double-down"})])}],!1,null,null,null);t.a=N.exports},PLx1:function(e,t,s){(e.exports=s("I1BE")(!1)).push([e.i,".settings-wrapper{flex-direction:column}.settings-wrapper,.settings-wrapper .settings{display:flex;height:100%;max-height:100%;overflow:hidden}.settings-wrapper .settings{flex-grow:1;justify-content:stretch;align-items:stretch;position:relative;padding:.85rem;flex-direction:row}.settings-wrapper .settings .switch-wrapper>.input-group-material-label{padding-left:0}.settings-wrapper .settings-footer{box-shadow:0 -2px 6px 0 rgba(0,0,0,.4);z-index:1}",""])},aWil:function(e,t,s){"use strict";s("nibG")},akQX:function(e,t,s){"use strict";s.d(t,"a",(function(){return u})),s.d(t,"e",(function(){return m})),s.d(t,"c",(function(){return d})),s.d(t,"b",(function(){return f})),s.d(t,"d",(function(){return p}));var o=s("V0LQ");navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert($t("misc.get_user_media_not_supported")),navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(navigator.enumerateDevices=function(e){navigator.mediaDevices.enumerateDevices().then(e)});var a="https:"===location.protocol,i=[],r=!1;("undefined"!=typeof MediaStreamTrack&&"getSources"in MediaStreamTrack||navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)&&(r=!0);var n={hasMicrophone:!1,hasWebcam:!1,isMicrophoneAlreadyCaptured:!1,isWebcamAlreadyCaptured:!1,permissionError:!0},c=function(e){r&&(!navigator.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(navigator.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!navigator.enumerateDevices&&navigator.enumerateDevices&&(navigator.enumerateDevices=navigator.enumerateDevices.bind(navigator)),navigator.enumerateDevices?(i=[],navigator.enumerateDevices((function(t){t.forEach((function(e){var t,s={};for(var o in e)s[o]=e[o];"audio"===s.kind&&(s.kind="audioinput"),"video"===s.kind&&(s.kind="videoinput"),i.forEach((function(e){e.id===s.id&&e.kind===s.kind&&(t=!0)})),t||(s.deviceId||(s.deviceId=s.id),s.id||(s.id=s.deviceId),s.label?("videoinput"!==s.kind||n.isWebcamAlreadyCaptured||(n.isWebcamAlreadyCaptured=!0),"audioinput"!==s.kind||n.isMicrophoneAlreadyCaptured||(n.isMicrophoneAlreadyCaptured=!0)):(s.label="Please invoke getUserMedia once.",a||(s.label="HTTPs is required to get label of this "+s.kind+" device.")),"audioinput"===s.kind&&(n.hasMicrophone=!0),"videoinput"===s.kind&&(n.hasWebcam=!0),i.push(s))})),e&&e(n)}))):e&&e(n))},u=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];c((function(s){if(s){var o=!1;e&&!s.hasMicrophone&&(o=!0),t&&!s.hasWebcam&&(o=!0),o&&h(s)}}))},m=function(e){var t={icon:"error",footer:$t("misc.solve_and_refresh")};if(e)return"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?(t.title=$t("misc.media.permission_denied"),t.text=$t("misc.media.permission_denied_text")):"NotFoundError"===e.name?(t.title=$t("misc.media.not_found"),t.text=$t("misc.media.not_found_text")):"NotReadableError"===e.name||"OverconstrainedError"===e.name?(t.title=$t("misc.media.unreadable"),t.text=$t("misc.media.unreadable_text")):"SecurityError"!==e.name&&"TypeError"!==e.name||(t.title=$t("misc.media.security"),t.text=$t("misc.media.security_text")),{msg:t,alert:swtAlert.fire(t)}},h=function(e){var t=[];e.hasMicrophone||t.push("Microphone"),e.hasWebcam||t.push("WebCam");var s={icon:"error",title:$t("misc.media.missing"),text:$t("misc.media.missing_text",{attribute:t.join(", ")}),footer:$t("misc.solve_and_refresh")};swtAlert.fire(s)},l=function(e){if((e=Object.assign({},{type:null,loop:!1,duration:1e3},e)).type){var t=new Audio;return t.preload="auto",t.autoplay=!0,t.loop=e.loop,t.src="/sound/".concat(e.type,".mp3"),t.play().then((function(){setTimeout((function(){t&&t.pause()}),e.duration)})).catch((function(e){console.error(e)})),t}},d=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!document.hasFocus()||e)return l({type:"calling",loop:!0,duration:3e4})},f=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!document.hasFocus()||e)return l({type:"message",duration:3e3})},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,s=document.querySelector("link[rel=canonical]")?document.querySelector("link[rel=canonical]").href:document.location.href,a=e.url?e.url:s;if(navigator.share)navigator.share({title:e.title?e.title:document.title,url:a}).then((function(){console.log("Thanks for sharing!")})).catch(console.error);else{var i={showCancelButton:!0,confirmButtonText:$t("misc.share_alert.confirm_btn"),cancelButtonText:$t("misc.share_alert.cancel_btn")};e.alertTitle&&(i.title=e.alertTitle),e.alertHtml?i.html=e.alertHtml:i.text=$t("misc.share_alert.text"),swtAlert.fire(i).then((function(e){e.value&&(Object(o.c)(a),setTimeout((function(){t()}),500))}))}}},nibG:function(e,t,s){var o=s("8Cr2");"string"==typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};s("aET+")(o,a);o.locals&&(e.exports=o.locals)},yufk:function(e,t,s){var o=s("PLx1");"string"==typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};s("aET+")(o,a);o.locals&&(e.exports=o.locals)}}]);
//# sourceMappingURL=app-layout.js.map?id=995526f5d783608ebdc4