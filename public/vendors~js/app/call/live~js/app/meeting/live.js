(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{zWga:function(e,n,t){"use strict";(function(t,i){var o,r=function(r,s){var a;function d(e,n){function t(e){return!e.audio&&!e.video&&!e.screen&&e.data}var i="";i+="?userid="+e.userid,i+="&sessionid="+e.sessionid,i+="&msgEvent="+e.socketMessageEvent,i+="&socketCustomEvent="+e.socketCustomEvent,i+="&autoCloseEntireSession="+!!e.autoCloseEntireSession,!0===e.session.broadcast&&(i+="&oneToMany=true"),i+="&maxParticipantsAllowed="+e.maxParticipantsAllowed,e.enableScalableBroadcast&&(i+="&enableScalableBroadcast=true",i+="&maxRelayLimitPerUser="+(e.maxRelayLimitPerUser||2)),i+="&extra="+JSON.stringify(e.extra||{}),e.socketCustomParameters&&(i+=e.socketCustomParameters);try{io.sockets={}}catch(e){}if(e.socketURL||(e.socketURL="/"),"/"!=e.socketURL.substr(e.socketURL.length-1,1))throw'"socketURL" MUST end with a slash.';e.enableLogs&&("/"==e.socketURL?console.info("socket.io url is: ",location.origin+"/"):console.info("socket.io url is: ",e.socketURL));try{e.socket=io(e.socketURL+i)}catch(n){e.socket=io.connect(e.socketURL+i,e.socketOptions)}var o=e.multiPeersHandler;function r(n,t){e.peersBackup[n]||(e.peersBackup[n]={userid:n,extra:{}}),e.peersBackup[n].extra=t}e.socket.on("extra-data-updated",(function(n,t){e.peers[n]&&(e.peers[n].extra=t,e.onExtraDataUpdated({userid:n,extra:t}),r(n,t))})),e.socket.on(e.socketMessageEvent,(function n(i){if(i.remoteUserId==e.userid)if(e.peers[i.sender]&&e.peers[i.sender].extra!=i.message.extra&&(e.peers[i.sender].extra=i.extra,e.onExtraDataUpdated({userid:i.sender,extra:i.extra}),r(i.sender,i.extra)),i.message.streamSyncNeeded&&e.peers[i.sender]){var s=e.streamEvents[i.message.streamid];if(!s||!s.stream)return;var a=i.message.action;if("ended"===a||"inactive"===a||"stream-removed"===a)return e.peersBackup[s.userid]&&(s.extra=e.peersBackup[s.userid].extra),void e.onstreamended(s);var d="both"!=i.message.type?i.message.type:null;"function"==typeof s.stream[a]&&s.stream[a](d)}else if("dropPeerConnection"!==i.message){if(i.message.allParticipants)return-1===i.message.allParticipants.indexOf(i.sender)&&i.message.allParticipants.push(i.sender),void i.message.allParticipants.forEach((function(n){o[e.peers[n]?"renegotiatePeer":"createNewPeer"](n,{localPeerSdpConstraints:{OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:e.session.oneway?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.session.oneway?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!e.session.oneway||"one-way"===e.direction,isDataOnly:t(e.session)})}));if(i.message.newParticipant){if(i.message.newParticipant==e.userid)return;if(e.peers[i.message.newParticipant])return;o.createNewPeer(i.message.newParticipant,i.message.userPreferences||{localPeerSdpConstraints:{OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:e.session.oneway?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.session.oneway?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!e.session.oneway||"one-way"===e.direction,isDataOnly:t(e.session)})}else if(i.message.readyForOffer&&(e.attachStreams.length&&(e.waitingForLocalMedia=!1),e.waitingForLocalMedia))setTimeout((function(){n(i)}),1);else if(i.message.newParticipationRequest&&i.sender!==e.userid){e.peers[i.sender]&&e.deletePeer(i.sender);var c={extra:i.extra||{},localPeerSdpConstraints:i.message.remotePeerSdpConstraints||{OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:i.message.localPeerSdpConstraints||{OfferToReceiveAudio:e.session.oneway?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.session.oneway?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:void 0!==i.message.isOneWay?i.message.isOneWay:!!e.session.oneway||"one-way"===e.direction,isDataOnly:void 0!==i.message.isDataOnly?i.message.isDataOnly:t(e.session),dontGetRemoteStream:void 0!==i.message.isOneWay?i.message.isOneWay:!!e.session.oneway||"one-way"===e.direction,dontAttachLocalStream:!!i.message.dontGetRemoteStream,connectionDescription:i,successCallback:function(){}};e.onNewParticipant(i.sender,c)}else{if(i.message.changedUUID&&e.peers[i.message.oldUUID]&&(e.peers[i.message.newUUID]=e.peers[i.message.oldUUID],delete e.peers[i.message.oldUUID]),i.message.userLeft)return o.onUserLeft(i.sender),void(i.message.autoCloseEntireSession&&e.leave());o.addNegotiatedMessage(i.message,i.sender)}}else e.deletePeer(i.sender)}));var s=!1;e.socket.resetProps=function(){s=!1},e.socket.on("connect",(function(){s||(s=!0,e.enableLogs&&console.info("socket.io connection is opened."),setTimeout((function(){e.socket.emit("extra-data-updated",e.extra)}),1e3),n&&n(e.socket))})),e.socket.on("disconnect",(function(n){e.onSocketDisconnect(n)})),e.socket.on("error",(function(n){e.onSocketError(n)})),e.socket.on("user-disconnected",(function(n){n!==e.userid&&(e.onUserStatusChanged({userid:n,status:"offline",extra:e.peers[n]&&e.peers[n].extra||{}}),e.deletePeer(n))})),e.socket.on("user-connected",(function(n){n!==e.userid&&e.onUserStatusChanged({userid:n,status:"online",extra:e.peers[n]&&e.peers[n].extra||{}})})),e.socket.on("closed-entire-session",(function(n,t){e.leave(),e.onEntireSessionClosed({sessionid:n,userid:n,extra:t})})),e.socket.on("userid-already-taken",(function(n,t){e.onUserIdAlreadyTaken(n,t)})),e.socket.on("logs",(function(n){e.enableLogs&&console.debug("server-logs",n)})),e.socket.on("number-of-broadcast-viewers-updated",(function(n){e.onNumberOfBroadcastViewersUpdated(n)})),e.socket.on("set-isInitiator-true",(function(n){n==e.sessionid&&(e.isInitiator=!0)}))}function c(e){var n=this,t=["getAllParticipants","getLength","selectFirst","streams","send","forEach"];function i(){e.fbr=new FileBufferReader,e.fbr.onProgress=function(n){e.onFileProgress(n)},e.fbr.onBegin=function(n){e.onFileStart(n)},e.fbr.onEnd=function(n){e.onFileEnd(n)}}e.peers={getLength:function(){var e=0;for(var n in this)-1==t.indexOf(n)&&e++;return e},selectFirst:function(){var e;for(var n in this)-1==t.indexOf(n)&&(e=this[n]);return e},getAllParticipants:function(e){var n=[];for(var i in this)-1==t.indexOf(i)&&i!=e&&n.push(i);return n},forEach:function(n){this.getAllParticipants().forEach((function(t){n(e.peers[t])}))},send:function(t,i){var o=this;if(!h(t.size)&&!h(t.type)){if(e.enableFileSharing)return void n.shareFile(t,i);"string"!=typeof t&&(t=JSON.stringify(t))}if("text"===t.type||t instanceof ArrayBuffer||t instanceof DataView){if("text"===t.type&&(t=JSON.stringify(t)),i){var r=e.peers[i];if(r)return r.channels.length?void r.channels.forEach((function(e){e.send(t)})):(e.peers[i].createDataChannel(),e.renegotiate(i),void setTimeout((function(){o.send(t,i)}),3e3))}this.getAllParticipants().forEach((function(n){if(!o[n].channels.length)return e.peers[n].createDataChannel(),e.renegotiate(n),void setTimeout((function(){o[n].channels.forEach((function(e){e.send(t)}))}),3e3);o[n].channels.forEach((function(e){e.send(t)}))}))}else N.send({text:t,channel:this,connection:e,remoteUserId:i})}},this.uuid=e.userid,this.getLocalConfig=function(t,o,r){return r||(r={}),{streamsToShare:r.streamsToShare||{},rtcMultiConnection:e,connectionDescription:r.connectionDescription,userid:o,localPeerSdpConstraints:r.localPeerSdpConstraints,remotePeerSdpConstraints:r.remotePeerSdpConstraints,dontGetRemoteStream:!!r.dontGetRemoteStream,dontAttachLocalStream:!!r.dontAttachLocalStream,renegotiatingPeer:!!r.renegotiatingPeer,peerRef:r.peerRef,channels:r.channels||[],onLocalSdp:function(e){n.onNegotiationNeeded(e,o)},onLocalCandidate:function(t){(t=D.processCandidates(e,t))&&n.onNegotiationNeeded(t,o)},remoteSdp:t,onDataChannelMessage:function(t){if(!e.fbr&&e.enableFileSharing&&i(),"string"!=typeof t&&e.enableFileSharing){var r=this;t instanceof ArrayBuffer||t instanceof DataView?e.fbr.convertToObject(t,(function(e){r.onDataChannelMessage(e)})):t.readyForNextChunk?e.fbr.getNextChunk(t,(function(n,t){e.peers[o].channels.forEach((function(e){e.send(n)}))}),o):t.chunkMissing?e.fbr.chunkMissing(t):e.fbr.addChunk(t,(function(n){e.peers[o].peer.channel.send(n)}))}else n.onDataChannelMessage(t,o)},onDataChannelError:function(e){n.onDataChannelError(e,o)},onDataChannelOpened:function(e){n.onDataChannelOpened(e,o)},onDataChannelClosed:function(e){n.onDataChannelClosed(e,o)},onRemoteStream:function(t){e.peers[o]&&e.peers[o].streams.push(t),n.onGettingRemoteMedia(t,o)},onRemoteStreamRemoved:function(e){n.onRemovingRemoteMedia(e,o)},onPeerStateChanged:function(e){n.onPeerStateChanged(e),"new"===e.iceConnectionState&&n.onNegotiationStarted(o,e),"connected"===e.iceConnectionState&&n.onNegotiationCompleted(o,e),-1!==e.iceConnectionState.search(/closed|failed/gi)&&(n.onUserLeft(o),n.disconnectWith(o))}}},this.createNewPeer=function(n,t){if(!(e.maxParticipantsAllowed<=e.getAllParticipants().length)){if(t=t||{},e.isInitiator&&e.session.audio&&"two-way"===e.session.audio&&!t.streamsToShare&&(t.isOneWay=!1,t.isDataOnly=!1,t.session=e.session),!t.isOneWay&&!t.isDataOnly)return t.isOneWay=!0,void this.onNegotiationNeeded({enableMedia:!0,userPreferences:t},n);t=e.setUserPreferences(t,n);var i=this.getLocalConfig(null,n,t);e.peers[n]=new M(i)}},this.createAnsweringPeer=function(n,t,i){i=e.setUserPreferences(i||{},t);var o=this.getLocalConfig(n,t,i);e.peers[t]=new M(o)},this.renegotiatePeer=function(n,t,i){if(e.peers[n]){t||(t={}),t.renegotiatingPeer=!0,t.peerRef=e.peers[n].peer,t.channels=e.peers[n].channels;var o=this.getLocalConfig(i,n,t);e.peers[n]=new M(o)}else e.enableLogs&&console.error("Peer ("+n+") does not exist. Renegotiation skipped.")},this.replaceTrack=function(n,t,i){if(!e.peers[t])throw"This peer ("+t+") does not exist.";var o=e.peers[t].peer;o.getSenders&&"function"==typeof o.getSenders&&o.getSenders().length?o.getSenders().forEach((function(o){i&&"video"===o.track.kind&&(e.peers[t].peer.lastVideoTrack=o.track,o.replaceTrack(n)),i||"audio"!==o.track.kind||(e.peers[t].peer.lastAudioTrack=o.track,o.replaceTrack(n))})):(console.warn("RTPSender.replaceTrack is NOT supported."),this.renegotiatePeer(t))},this.onNegotiationNeeded=function(e,n){},this.addNegotiatedMessage=function(t,i){if(t.type&&t.sdp)return"answer"==t.type&&e.peers[i]&&e.peers[i].addRemoteSdp(t),"offer"==t.type&&(t.renegotiatingPeer?this.renegotiatePeer(i,null,t):this.createAnsweringPeer(t,i)),void(e.enableLogs&&console.log("Remote peer's sdp:",t.sdp));if(t.candidate)return e.peers[i]&&e.peers[i].addRemoteCandidate(t),void(e.enableLogs&&console.log("Remote peer's candidate pairs:",t.candidate));if(t.enableMedia){e.session=t.userPreferences.session||e.session,e.session.oneway&&e.attachStreams.length&&(e.attachStreams=[]),t.userPreferences.isDataOnly&&e.attachStreams.length&&(e.attachStreams.length=[]);var o={};e.attachStreams.forEach((function(e){o[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}})),t.userPreferences.streamsToShare=o,n.onNegotiationNeeded({readyForOffer:!0,userPreferences:t.userPreferences},i)}t.readyForOffer&&e.onReadyForOffer(i,t.userPreferences)},this.onGettingRemoteMedia=function(e,n){},this.onRemovingRemoteMedia=function(e,n){},this.onGettingLocalMedia=function(e){},this.onLocalMediaError=function(n,t){e.onMediaError(n,t)},this.shareFile=function(n,t){i(),e.fbr.readAsArrayBuffer(n,(function(n){var i=e.getAllParticipants();t&&(i=[t]),i.forEach((function(t){e.fbr.getNextChunk(n,(function(n){e.peers[t].channels.forEach((function(e){e.send(n)}))}),t)}))}),{userid:e.userid,chunkSize:"Firefox"===DetectRTC.browser.name?15e3:e.chunkSize||0})};var o=new I(e);this.onDataChannelMessage=function(n,t){o.receive(JSON.parse(n),t,e.peers[t]?e.peers[t].extra:{})},this.onDataChannelClosed=function(n,t){n.userid=t,n.extra=e.peers[t]?e.peers[t].extra:{},e.onclose(n)},this.onDataChannelError=function(n,t){n.userid=t,event.extra=e.peers[t]?e.peers[t].extra:{},e.onerror(n)},this.onDataChannelOpened=function(n,t){e.peers[t].channels.length?e.peers[t].channels=[n]:(e.peers[t].channels.push(n),e.onopen({userid:t,extra:e.peers[t]?e.peers[t].extra:{},channel:n}))},this.onPeerStateChanged=function(n){e.onPeerStateChanged(n)},this.onNegotiationStarted=function(e,n){},this.onNegotiationCompleted=function(e,n){},this.getRemoteStreams=function(n){return n=n||e.peers.getAllParticipants()[0],e.peers[n]?e.peers[n].streams:[]}}function u(e,n,t){if("undefined"!=typeof CustomEvent){var i=new CustomEvent(n,{arguments:t,__exposedProps__:t});e.dispatchEvent(i)}}function l(e,n){n.stream&&n.stream&&n.stream.addEventListener&&(n.stream.addEventListener("mute",(function(t){(t=e.streamEvents[n.streamid]).session={audio:"audio"===t.muteType,video:"video"===t.muteType},e.onmute(t)}),!1),n.stream.addEventListener("unmute",(function(t){(t=e.streamEvents[n.streamid]).session={audio:"audio"===t.unmuteType,video:"video"===t.unmuteType},e.onunmute(t)}),!1))}function f(){if(window.crypto&&window.crypto.getRandomValues&&-1===navigator.userAgent.indexOf("Safari")){for(var e=window.crypto.getRandomValues(new Uint32Array(3)),n="",t=0,i=e.length;t<i;t++)n+=e[t].toString(36);return n}return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")}function m(e,n,t){if(t.autoCreateMediaElement){var i=!1;C(e,"video").length||e.isVideo||e.isScreen||(i=!0),"Firefox"===DetectRTC.browser.name&&(t.session.video||t.session.screen)&&(i=!1);var o=document.createElement(i?"audio":"video");if(o.srcObject=e,o.setAttribute("autoplay",!0),o.setAttribute("playsinline",!0),o.setAttribute("controls",!0),o.setAttribute("muted",!1),o.setAttribute("volume",1),"Firefox"===DetectRTC.browser.name){var r="ended";"oninactive"in o&&(r="inactive"),o.addEventListener(r,(function(){if(currentUserMediaRequest.remove(e.idInstance),"local"===e.type){r="ended","oninactive"in e&&(r="inactive"),U.onSyncNeeded(e.streamid,r),t.attachStreams.forEach((function(n,i){e.streamid===n.streamid&&delete t.attachStreams[i]}));var n=[];t.attachStreams.forEach((function(e){e&&n.push(e)})),t.attachStreams=n;var i=t.streamEvents[e.streamid];if(i)return void t.onstreamended(i);this.parentNode&&this.parentNode.removeChild(this)}}),!1)}var s=o.play();if(void 0!==s){var a=!1;setTimeout((function(){a||(a=!0,n(o))}),1e3),s.then((function(){a||(a=!0,n(o))})).catch((function(e){a||(a=!0,n(o))}))}else n(o)}else n({})}function p(e,n){window.removeEventListener(e,n),window.addEventListener(e,n,!1)}function v(e){var n=[];return e.forEach((function(e){e&&n.push(e)})),n}function g(e){return!e.audio&&!e.video&&!e.screen&&e.data}function h(e){return void 0===e}(a=void 0!==t?t:null)&&"undefined"==typeof window&&void 0!==t&&(t.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function(){}},t.console||(t.console={}),void 0===t.console.debug&&(t.console.debug=t.console.info=t.console.error=t.console.log=t.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(a.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""}};return e},document.addEventListener=document.removeEventListener=a.addEventListener=a.removeEventListener=function(){},a.HTMLVideoElement=a.HTMLMediaElement=function(){}),"undefined"==typeof io&&(a.io=function(){return{on:function(e,n){n=n||function(){},"connect"===e&&n()},emit:function(e,n,t){t=t||function(){},"open-room"!==e&&"join-room"!==e||t(!0,n.sessionid,null)}}}),"undefined"==typeof location&&(a.location={protocol:"file:",href:"",hash:"",origin:"self"}),"undefined"==typeof screen&&(a.screen={width:0,height:0}),"undefined"==typeof URL&&(a.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),a.window=t),function(){var r="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";if(y="object"==typeof i&&"object"==typeof i.versions&&i.versions.node&&!i.browser){var s=i.versions.node.toString().replace("v","");r="Nodejs/"+s+" (NodeOS) AppleWebKit/"+s+" (KHTML, like Gecko) Nodejs/"+s+" Nodejs/"+s}!function(e){"undefined"==typeof window&&("undefined"==typeof window&&void 0!==t&&(t.navigator={userAgent:r,getUserMedia:function(){}},e.window=t),"undefined"==typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(e.screen={width:0,height:0}))}(void 0!==t?t:window);var a=window.navigator;void 0!==a?(void 0!==a.webkitGetUserMedia&&(a.getUserMedia=a.webkitGetUserMedia),void 0!==a.mozGetUserMedia&&(a.getUserMedia=a.mozGetUserMedia)):a={getUserMedia:function(){},userAgent:r};var d=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(a.userAgent||""),c=!(-1===a.userAgent.indexOf("Edge")||!a.msSaveOrOpenBlob&&!a.msSaveBlob),u=!!window.opera||a.userAgent.indexOf(" OPR/")>=0,l=void 0!==window.InstallTrigger,f=/^((?!chrome|android).)*safari/i.test(a.userAgent),m=!!window.chrome&&!u,p="undefined"!=typeof document&&!!document.documentMode&&!c;function v(e,n){var t=0,i=!1,o=window.setInterval((function(){e()&&(window.clearInterval(o),n(i)),t++>50&&(window.clearInterval(o),n(i=!0))}),10)}var g={Android:function(){return a.userAgent.match(/Android/i)},BlackBerry:function(){return a.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return a.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return a.userAgent.match(/Opera Mini/i)},Windows:function(){return a.userAgent.match(/IEMobile/i)},any:function(){return g.Android()||g.BlackBerry()||g.iOS()||g.Opera()||g.Windows()},getOsName:function(){var e="Unknown OS";return g.Android()&&(e="Android"),g.BlackBerry()&&(e="BlackBerry"),g.iOS()&&(e="iOS"),g.Opera()&&(e="Opera Mini"),g.Windows()&&(e="Windows"),e}};var h="Unknown OS",w="Unknown OS Version";var S,C,b=function(){for(var e,n=a.appVersion,t=a.userAgent,i="-",o=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],r=0;e=o[r];r++)if(e.r.test(t)){i=e.s;break}var s="-";switch(/Windows/.test(i)&&(/Windows (.*)/.test(i)&&(s=/Windows (.*)/.exec(i)[1]),i="Windows"),i){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(t)&&(s=/Mac OS X (10[\.\_\d]+)/.exec(t)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(t)&&(s=/Android ([\.\_\d]+)/.exec(t)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(t)&&(s=(s=/OS (\d+)_(\d+)_?(\d+)?/.exec(n))[1]+"."+s[2]+"."+(0|s[3]))}return{osName:i,osVersion:s}}();b&&b.osName&&"-"!=b.osName?(h=b.osName,w=b.osVersion):g.any()&&"Android"==(h=g.getOsName())&&(w=!!(C=(S=(S||a.userAgent).toLowerCase()).match(/android\s([0-9\.]*)/))&&C[1]);var y="object"==typeof i&&"object"==typeof i.versions&&i.versions.node;"Unknown OS"===h&&y&&(h="Nodejs",w=i.versions.node.toString().replace("v",""));var k=!1,T=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach((function(e){"undefined"!=typeof document&&"function"==typeof document.createElement&&(!k&&e in document.createElement("canvas")&&(k=!0),!T&&e in document.createElement("video")&&(T=!0))}));var R=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,E=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,x=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/;var M=[],O=[],D=[],A=[];a.mediaDevices&&a.mediaDevices.enumerateDevices&&(a.enumerateDevices=function(e){var n=a.mediaDevices.enumerateDevices();n&&n.then?a.mediaDevices.enumerateDevices().then(e).catch((function(){e([])})):e([])});var L=!1;(void 0!==P&&"getSources"in P||a.mediaDevices&&a.mediaDevices.enumerateDevices)&&(L=!0);var U=!1,I=!1,N=!1,W=!1,V=!1;function B(e){if(L)if(!a.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(a.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!a.enumerateDevices&&a.enumerateDevices&&(a.enumerateDevices=a.enumerateDevices.bind(a)),a.enumerateDevices){M=[],O=[],D=[],A=[],U=!1,I=!1,N=!1,W=!1,V=!1;var n={};a.enumerateDevices((function(t){t.forEach((function(e){var t={};for(var i in e)try{"function"!=typeof e[i]&&(t[i]=e[i])}catch(e){}n[t.deviceId+t.label+t.kind]||("audio"===t.kind&&(t.kind="audioinput"),"video"===t.kind&&(t.kind="videoinput"),t.deviceId||(t.deviceId=t.id),t.id||(t.id=t.deviceId),t.label?("videoinput"!==t.kind||V||(V=!0),"audioinput"!==t.kind||W||(W=!0)):(t.isCustomLabel=!0,"videoinput"===t.kind?t.label="Camera "+(A.length+1):"audioinput"===t.kind?t.label="Microphone "+(O.length+1):"audiooutput"===t.kind?t.label="Speaker "+(D.length+1):t.label="Please invoke getUserMedia once.",void 0!==F&&F.browser.isChrome&&F.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(t.label="HTTPs is required to get label of this "+t.kind+" device.")),"audioinput"===t.kind&&(U=!0,-1===O.indexOf(t)&&O.push(t)),"audiooutput"===t.kind&&(I=!0,-1===D.indexOf(t)&&D.push(t)),"videoinput"===t.kind&&(N=!0,-1===A.indexOf(t)&&A.push(t)),M.push(t),n[t.deviceId+t.label+t.kind]=t)})),void 0!==F&&(F.MediaDevices=M,F.hasMicrophone=U,F.hasSpeakers=I,F.hasWebcam=N,F.isWebsiteHasWebcamPermissions=V,F.isWebsiteHasMicrophonePermissions=W,F.audioInputDevices=O,F.audioOutputDevices=D,F.videoInputDevices=A),e&&e()}))}else e&&e();else e&&e()}var F=window.DetectRTC||{};F.browser=function(){a.appVersion;var e,n,t,i=a.userAgent,o=a.appName,r=""+parseFloat(a.appVersion),s=parseInt(a.appVersion,10);if(f&&!m&&-1!==i.indexOf("CriOS")&&(f=!1,m=!0),u){o="Opera";try{s=(r=a.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(e){r="0.0.0.0",s=0}}else p?((n=i.indexOf("rv:"))>0?r=i.substring(n+3):(n=i.indexOf("MSIE"),r=i.substring(n+5)),o="IE"):m?(n=i.indexOf("Chrome"),o="Chrome",r=i.substring(n+7)):f?(n=i.indexOf("Safari"),o="Safari",r=i.substring(n+7),-1!==(n=i.indexOf("Version"))&&(r=i.substring(n+8)),-1!==a.userAgent.indexOf("Version/")&&(r=a.userAgent.split("Version/")[1].split(" ")[0])):l?(n=i.indexOf("Firefox"),o="Firefox",r=i.substring(n+8)):(e=i.lastIndexOf(" ")+1)<(n=i.lastIndexOf("/"))&&(o=i.substring(e,n),r=i.substring(n+1),o.toLowerCase()===o.toUpperCase()&&(o=a.appName));return c&&(o="Edge",r=a.userAgent.split("Edge/")[1]),-1!==(t=r.search(/[; \)]/))&&(r=r.substring(0,t)),s=parseInt(""+r,10),isNaN(s)&&(r=""+parseFloat(a.appVersion),s=parseInt(a.appVersion,10)),{fullVersion:r,version:s,name:o,isPrivateBrowsing:!1}}(),function(e){var n;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,(function(){n=!1}),(function(e){n=!0}));else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var t;try{(t=window.indexedDB.open("test")).onerror=function(){return!0}}catch(e){n=!0}void 0===n&&v((function(){return"done"===t.readyState}),(function(e){e||(n=!t.result)}))}else if(function(e){var n=e.toLowerCase();if(0===n.indexOf("msie")&&0===n.indexOf("trident"))return!1;var t=/(?:msie|rv:)\s?([\d\.]+)/.exec(n);return!!(t&&parseInt(t[1],10)>=10)}(window.navigator.userAgent)){n=!1;try{window.indexedDB||(n=!0)}catch(e){n=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){n=!0}void 0===n&&(n=!1,window.localStorage.removeItem("test"))}}catch(e){n=!1}v((function(){return void 0!==n}),(function(t){e(n)}))}((function(e){F.browser.isPrivateBrowsing=!!e})),F.browser["is"+F.browser.name]=!0,F.osName=h,F.osVersion=w;"object"==typeof i&&"object"==typeof i.versions&&i.versions["node-webkit"];var q=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach((function(e){q||e in window&&(q=!0)})),F.isWebRTCSupported=q,F.isORTCSupported="undefined"!=typeof RTCIceGatherer;var G=!1;((F.browser.isChrome&&F.browser.version>=35||F.browser.isFirefox&&F.browser.version>=34||F.browser.isEdge&&F.browser.version>=17||"Android"===F.osName&&F.browser.isChrome)&&(G=!0),/^(https:|chrome-extension:)$/g.test(location.protocol||""))||("undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(F.browser.isChrome||F.browser.isEdge||F.browser.isOpera)||F.browser.isFirefox)&&(G=!1);F.isScreenCapturingSupported=G;var j={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach((function(e){j.isSupported||e in window&&(j.isSupported=!0,window[e]&&"createMediaStreamSource"in window[e].prototype&&(j.isCreateMediaStreamSourceSupported=!0))})),F.isAudioContextSupported=j.isSupported,F.isCreateMediaStreamSourceSupported=j.isCreateMediaStreamSourceSupported;var H=!1;F.browser.isChrome&&F.browser.version>31&&(H=!0),F.isRtpDataChannelsSupported=H;var z=!1;(F.browser.isFirefox&&F.browser.version>28||F.browser.isChrome&&F.browser.version>25||F.browser.isOpera&&F.browser.version>=11)&&(z=!0),F.isSctpDataChannelsSupported=z,F.isMobileDevice=d;var _=!1;(a.getUserMedia||a.mediaDevices&&a.mediaDevices.getUserMedia)&&(_=!0),F.browser.isChrome&&F.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(_="Requires HTTPs"),"Nodejs"===F.osName&&(_=!1),F.isGetUserMediaSupported=_;var J,X,K,Y="";screen.width&&(Y+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:""));F.displayResolution=Y,F.displayAspectRatio=(J=screen.width,X=screen.height,K=function e(n,t){return 0==t?n:e(t,n%t)}(J,X),J/K/(X/K)).toFixed(2),F.isCanvasSupportsStreamCapturing=k,F.isVideoSupportsStreamCapturing=T,"Chrome"==F.browser.name&&F.browser.version>=53&&(F.isCanvasSupportsStreamCapturing||(F.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),F.isVideoSupportsStreamCapturing||(F.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),F.DetectLocalIPAddress=function(e,n){if(F.isWebRTCSupported){var t=!0,i=!0;!function(e,n){if("undefined"==typeof document||"function"!=typeof document.getElementById)return;var t={},i=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!i){var o=document.getElementById("iframe");if(!o)return;var r=o.contentWindow;i=r.RTCPeerConnection||r.mozRTCPeerConnection||r.webkitRTCPeerConnection}if(!i)return;var s=null;"Chrome"===F.browser&&F.browser.version<58&&(s={optional:[{RtpDataChannels:!0}]});var a=new i({iceServers:[{urls:"stun:stun.l.google.com:19302"}]},s);n&&(a.addStream?a.addStream(n):a.addTrack&&n.getTracks()[0]&&a.addTrack(n.getTracks()[0],n));function d(n){if(n){var i=E.exec(n);if(i){var o=i[1],r=n.match(R);void 0===t[o]&&e(o,r,!0),t[o]=!0}}else e()}if(a.onicecandidate=function(e){e.candidate&&e.candidate.candidate?d(e.candidate.candidate):d()},!n)try{a.createDataChannel("sctp",{})}catch(e){}F.isPromisesSupported?a.createOffer().then((function(e){a.setLocalDescription(e).then(c)})):a.createOffer((function(e){a.setLocalDescription(e,c,(function(){}))}),(function(){}));function c(){a.localDescription.sdp.split("\n").forEach((function(e){e&&0===e.indexOf("a=candidate:")&&d(e)}))}}((function(n){n?n.match(R)?e("Local: "+n,t=!1,i):n.match(x)?e("Public: "+n,t,i=!1):e("Public: "+n,t,i):e()}),n)}},F.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,F.isWebSocketsBlocked=!F.isWebSocketsSupported,"Nodejs"===F.osName&&(F.isWebSocketsSupported=!0,F.isWebSocketsBlocked=!1),F.checkWebSocketsSupport=function(e){e=e||function(){};try{var n,t=new WebSocket("wss://echo.websocket.org:443/");t.onopen=function(){F.isWebSocketsBlocked=!1,n=(new Date).getTime(),t.send("ping")},t.onmessage=function(){F.WebsocketLatency=(new Date).getTime()-n+"ms",e(),t.close(),t=null},t.onerror=function(){F.isWebSocketsBlocked=!0,e()}}catch(n){F.isWebSocketsBlocked=!0,e()}},F.load=function(e){B(e=e||function(){})},F.MediaDevices=void 0!==M?M:[],F.hasMicrophone=U,F.hasSpeakers=I,F.hasWebcam=N,F.isWebsiteHasWebcamPermissions=V,F.isWebsiteHasMicrophonePermissions=W,F.audioInputDevices=O,F.audioOutputDevices=D,F.videoInputDevices=A;var $=!1;"undefined"!=typeof document&&"function"==typeof document.createElement&&"setSinkId"in document.createElement("video")&&($=!0),F.isSetSinkIdSupported=$;var Q=!1;F.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(Q=!0):F.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(Q=!0),F.isRTPSenderReplaceTracksSupported=Q;var Z=!1;F.browser.isFirefox&&F.browser.version>38&&(Z=!0),F.isRemoteStreamProcessingSupported=Z;var ee=!1;void 0!==P&&"applyConstraints"in P.prototype&&(ee=!0),F.isApplyConstraintsSupported=ee;var ne=!1;F.browser.isFirefox&&F.browser.version>=43&&(ne=!0),F.isMultiMonitorScreenCapturingSupported=ne,F.isPromisesSupported=!!("Promise"in window),F.version="1.3.9",void 0===F&&(window.DetectRTC={});var te=window.MediaStream;void 0===te&&"undefined"!=typeof webkitMediaStream&&(te=webkitMediaStream),F.MediaStream=void 0!==te&&"function"==typeof te&&Object.keys(te.prototype),F.MediaStreamTrack=void 0!==P&&Object.keys(P.prototype);var ie=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;F.RTCPeerConnection=void 0!==ie&&Object.keys(ie.prototype),window.DetectRTC=F,e.exports=F,void 0===(o=function(){return F}.apply(n,[]))||(e.exports=o)}(),"undefined"!=typeof cordova&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Crosswalk")&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),window.addEventListener||(window.addEventListener=function(e,n,t){e.attachEvent&&e.attachEvent("on"+n,t)}),window.attachEventListener=function(e,n,t,i){e.addEventListener(n,t,i)};var w=window.MediaStream;function S(e,n){return(!e.session.audio||"two-way"!==e.session.audio)&&("Firefox"===DetectRTC.browser.name&&!1!==n||!("Chrome"!==DetectRTC.browser.name||DetectRTC.browser.version<50)&&(!0===typeof n||!(void 0!==n||!e.session.audio||!e.session.screen||e.session.video)&&(n=!0,!0)))}function C(e,n){return e&&e.getTracks?e.getTracks().filter((function(e){return e.kind===(n||"audio")})):[]}function b(){var e=!1;try{if("undefined"==typeof RTCRtpTransceiver)return!1;if(!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var n=new k;try{n.addTransceiver("audio"),e=!0}catch(e){}n.close()}catch(n){e=!1}return e&&function(){var e=!1;try{var n=new k({sdpSemantics:"unified-plan"});try{var t=n.getConfiguration();e="unified-plan"==t.sdpSemantics||(t.sdpSemantics,!1)}catch(n){e=!1}}catch(n){e=!1}return e}()}function y(){if("undefined"!=typeof cordova&&void 0!==cordova.plugins&&void 0!==cordova.plugins.iosrtc){var e=cordova.plugins.iosrtc;window.webkitRTCPeerConnection=e.RTCPeerConnection,window.RTCSessionDescription=e.RTCSessionDescription,window.RTCIceCandidate=e.RTCIceCandidate,window.MediaStream=e.MediaStream,window.MediaStreamTrack=e.MediaStreamTrack,navigator.getUserMedia=navigator.webkitGetUserMedia=e.getUserMedia,e.debug.enable("iosrtc*"),"function"==typeof e.selectAudioOutput&&e.selectAudioOutput(window.iOSDefaultAudioOutputDevice||"speaker"),e.registerGlobals()}}void 0===w&&"undefined"!=typeof webkitMediaStream&&(w=webkitMediaStream),void 0!==w&&("stop"in w.prototype||(w.prototype.stop=function(){this.getTracks().forEach((function(e){e.stop()}))})),window.iOSDefaultAudioOutputDevice=window.iOSDefaultAudioOutputDevice||"speaker",document.addEventListener("deviceready",y,!1),y();var k,T={};function R(e){return{OfferToReceiveAudio:!!e.OfferToReceiveAudio,OfferToReceiveVideo:!!e.OfferToReceiveVideo}}void 0!==window.RTCPeerConnection?k=window.RTCPeerConnection:"undefined"!=typeof mozRTCPeerConnection?k=mozRTCPeerConnection:"undefined"!=typeof webkitRTCPeerConnection&&(k=webkitRTCPeerConnection);var E=window.RTCSessionDescription||window.mozRTCSessionDescription,x=window.RTCIceCandidate||window.mozRTCIceCandidate,P=window.MediaStreamTrack;function M(e){if(void 0!==window.RTCPeerConnection?k=window.RTCPeerConnection:"undefined"!=typeof mozRTCPeerConnection?k=mozRTCPeerConnection:"undefined"!=typeof webkitRTCPeerConnection&&(k=webkitRTCPeerConnection),E=window.RTCSessionDescription||window.mozRTCSessionDescription,x=window.RTCIceCandidate||window.mozRTCIceCandidate,P=window.MediaStreamTrack,!k)throw"WebRTC 1.0 (RTCPeerConnection) API are NOT available in this browser.";var n=e.rtcMultiConnection;this.extra=e.remoteSdp?e.remoteSdp.extra:n.extra,this.userid=e.userid,this.streams=[],this.channels=e.channels||[],this.connectionDescription=e.connectionDescription,this.addStream=function(e){n.addStream(e,t.userid)},this.removeStream=function(e){n.removeStream(e,t.userid)};var t=this;e.remoteSdp&&(this.connectionDescription=e.remoteSdp.connectionDescription);var i,o={};T.sdpConstraints=R({OfferToReceiveAudio:!0,OfferToReceiveVideo:!0});var r=!!e.renegotiatingPeer;e.remoteSdp&&(r=!!e.remoteSdp.renegotiatingPeer);var s=[];if(n.attachStreams.forEach((function(e){e&&s.push(e)})),r)i=e.peerRef;else{var a="all";(n.candidates.turn||n.candidates.relay)&&(n.candidates.stun||n.candidates.reflexive||n.candidates.host||(a="relay"));try{var d={iceServers:n.iceServers,iceTransportPolicy:n.iceTransportPolicy||a};void 0!==n.iceCandidatePoolSize&&(d.iceCandidatePoolSize=n.iceCandidatePoolSize),void 0!==n.bundlePolicy&&(d.bundlePolicy=n.bundlePolicy),void 0!==n.rtcpMuxPolicy&&(d.rtcpMuxPolicy=n.rtcpMuxPolicy),n.sdpSemantics&&(d.sdpSemantics=n.sdpSemantics||"unified-plan"),n.iceServers&&n.iceServers.length||(d=null,n.optionalArgument=null),i=new k(d,n.optionalArgument)}catch(e){try{d={iceServers:n.iceServers};i=new k(d)}catch(e){i=new k}}}!i.getRemoteStreams&&i.getReceivers&&(i.getRemoteStreams=function(){var e=new w;return i.getReceivers().forEach((function(n){e.addTrack(n.track)})),[e]}),!i.getLocalStreams&&i.getSenders&&(i.getLocalStreams=function(){var e=new w;return i.getSenders().forEach((function(n){e.addTrack(n.track)})),[e]}),i.onicecandidate=function(o){if(o.candidate)n.trickleIce&&e.onLocalCandidate({candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex});else if(!n.trickleIce){var r=i.localDescription;e.onLocalSdp({type:r.type,sdp:r.sdp,remotePeerSdpConstraints:e.remotePeerSdpConstraints||!1,renegotiatingPeer:!!e.renegotiatingPeer||!1,connectionDescription:t.connectionDescription,dontGetRemoteStream:!!e.dontGetRemoteStream,extra:n?n.extra:{},streamsToShare:m})}},s.forEach((function(o){e.remoteSdp&&e.remoteSdp.remotePeerSdpConstraints&&e.remoteSdp.remotePeerSdpConstraints.dontGetRemoteStream||e.dontAttachLocalStream||(o=n.beforeAddingStream(o,t))&&(i.getLocalStreams().forEach((function(e){o&&e.id==o.id&&(o=null)})),o&&o.getTracks&&o.getTracks().forEach((function(e){try{i.addTrack(e,o)}catch(e){}})))})),i.oniceconnectionstatechange=i.onsignalingstatechange=function(){var o=t.extra;n.peers[t.userid]&&(o=n.peers[t.userid].extra||o),i&&(e.onPeerStateChanged({iceConnectionState:i.iceConnectionState,iceGatheringState:i.iceGatheringState,signalingState:i.signalingState,extra:o,userid:t.userid}),i&&i.iceConnectionState&&-1!==i.iceConnectionState.search(/closed|failed/gi)&&t.streams instanceof Array&&t.streams.forEach((function(e){var t=n.streamEvents[e.id]||{streamid:e.id,stream:e,type:"remote"};n.onstreamended(t)})))};var c={OfferToReceiveAudio:!!s.length,OfferToReceiveVideo:!!s.length};e.localPeerSdpConstraints&&(c=e.localPeerSdpConstraints),T.sdpConstraints=R(c);var u={};i.ontrack=function(n){if(n&&"track"===n.type)if(n.stream=n.streams[n.streams.length-1],n.stream.id||(n.stream.id=n.track.id),u[n.stream.id]&&"Safari"!==DetectRTC.browser.name)n.track&&(n.track.onended=function(){i&&i.onremovestream(n)});else{u[n.stream.id]=n.stream.id;var t={};e.remoteSdp&&e.remoteSdp.streamsToShare?t=e.remoteSdp.streamsToShare:e.streamsToShare&&(t=e.streamsToShare);var r=t[n.stream.id];r?(n.stream.isAudio=r.isAudio,n.stream.isVideo=r.isVideo,n.stream.isScreen=r.isScreen):(n.stream.isVideo=!!C(n.stream,"video").length,n.stream.isAudio=!n.stream.isVideo,n.stream.isScreen=!1),n.stream.streamid=n.stream.id,o[n.stream.id]=n.stream,e.onRemoteStream(n.stream),n.stream.getTracks().forEach((function(e){e.onended=function(){i&&i.onremovestream(n)}})),n.stream.onremovetrack=function(){i&&i.onremovestream(n)}}},i.onremovestream=function(n){n.stream.streamid=n.stream.id,o[n.stream.id]&&delete o[n.stream.id],e.onRemoteStreamRemoved(n.stream)},"function"!=typeof i.removeStream&&(i.removeStream=function(e){e.getTracks().forEach((function(n){i.removeTrack(n,e)}))}),this.addRemoteCandidate=function(e){i.addIceCandidate(new x(e))},this.addRemoteSdp=function(e,t){t=t||function(){},"Safari"!==DetectRTC.browser.name&&(e.sdp=n.processSdp(e.sdp)),i.setRemoteDescription(new E(e)).then(t,(function(i){n.enableLogs&&console.error("setRemoteDescription failed","\n",i,"\n",e.sdp),t()})).catch((function(i){n.enableLogs&&console.error("setRemoteDescription failed","\n",i,"\n",e.sdp),t()}))};var l=!0;function f(n){n.binaryType="arraybuffer",n.onmessage=function(n){e.onDataChannelMessage(n.data)},n.onopen=function(){e.onDataChannelOpened(n)},n.onerror=function(n){e.onDataChannelError(n)},n.onclose=function(n){e.onDataChannelClosed(n)},n.internalSend=n.send,n.send=function(e){"open"===n.readyState&&n.internalSend(e)},i.channel=n}e.remoteSdp&&(l=!1),this.createDataChannel=function(){f(i.createDataChannel("sctp",{}))},!0!==n.session.data||r||(l?this.createDataChannel():i.ondatachannel=function(e){f(e.channel)}),this.enableDisableVideoEncoding=function(e){var n;if(i.getSenders().forEach((function(e){n||"video"!==e.track.kind||(n=e)})),n&&n.getParameters){var t=n.getParameters();t.encodings[1]&&(t.encodings[1].active=!!e),t.encodings[2]&&(t.encodings[2].active=!!e),n.setParameters(t)}},e.remoteSdp&&(e.remoteSdp.remotePeerSdpConstraints&&(c=e.remoteSdp.remotePeerSdpConstraints),T.sdpConstraints=R(c),this.addRemoteSdp(e.remoteSdp,(function(){p("createAnswer")}))),"two-way"!=n.session.audio&&"two-way"!=n.session.video&&"two-way"!=n.session.screen||(T.sdpConstraints=R({OfferToReceiveAudio:"two-way"==n.session.audio||e.remoteSdp&&e.remoteSdp.remotePeerSdpConstraints&&e.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio,OfferToReceiveVideo:"two-way"==n.session.video||"two-way"==n.session.screen||e.remoteSdp&&e.remoteSdp.remotePeerSdpConstraints&&e.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio}));var m={};function p(o){i[o](T.sdpConstraints).then((function(o){"Safari"!==DetectRTC.browser.name&&(o.sdp=n.processSdp(o.sdp)),i.setLocalDescription(o).then((function(){n.trickleIce&&(e.onLocalSdp({type:o.type,sdp:o.sdp,remotePeerSdpConstraints:e.remotePeerSdpConstraints||!1,renegotiatingPeer:!!e.renegotiatingPeer||!1,connectionDescription:t.connectionDescription,dontGetRemoteStream:!!e.dontGetRemoteStream,extra:n?n.extra:{},streamsToShare:m}),n.onSettingLocalDescription(t))}),(function(e){n.enableLogs&&console.error("setLocalDescription error",e)}))}),(function(e){n.enableLogs&&console.error("sdp-error",e)}))}i.getLocalStreams().forEach((function(e){m[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}})),l&&p("createOffer"),i.nativeClose=i.close,i.close=function(){if(i){try{i.nativeClose!==i.close&&i.nativeClose()}catch(e){}i=null,t.peer=null}},this.peer=i}var O=function(){function e(e,i){var o=t(e);return o.videoCodecNumbers?"vp8"===i&&o.vp8LineNumber===o.videoCodecNumbers[0]||"vp9"===i&&o.vp9LineNumber===o.videoCodecNumbers[0]||"h264"===i&&o.h264LineNumber===o.videoCodecNumbers[0]?e:e=n(e,i,o):e}function n(e,n,t,i){var o="";if("vp8"===n){if(!t.vp8LineNumber)return e;o=t.vp8LineNumber}if("vp9"===n){if(!t.vp9LineNumber)return e;o=t.vp9LineNumber}if("h264"===n){if(!t.h264LineNumber)return e;o=t.h264LineNumber}var r=t.videoCodecNumbersOriginal.split("SAVPF")[0]+"SAVPF ",s=[o];return i&&(s=[]),t.videoCodecNumbers.forEach((function(e){e!==o&&s.push(e)})),r+=s.join(" "),e=e.replace(t.videoCodecNumbersOriginal,r)}function t(e){var n={};return e.split("\n").forEach((function(e){0===e.indexOf("m=video")&&(n.videoCodecNumbers=[],e.split("SAVPF")[1].split(" ").forEach((function(t){(t=t.trim())&&t.length&&(n.videoCodecNumbers.push(t),n.videoCodecNumbersOriginal=e)}))),-1===e.indexOf("VP8/90000")||n.vp8LineNumber||(n.vp8LineNumber=e.replace("a=rtpmap:","").split(" ")[0]),-1===e.indexOf("VP9/90000")||n.vp9LineNumber||(n.vp9LineNumber=e.replace("a=rtpmap:","").split(" ")[0]),-1===e.indexOf("H264/90000")||n.h264LineNumber||(n.h264LineNumber=e.replace("a=rtpmap:","").split(" ")[0])})),n}function i(e,n,t){return function(e,n,t,i,o){for(var r=-1!==t?t:e.length,s=n;s<r;++s)if(0===e[s].indexOf(i)&&(!o||-1!==e[s].toLowerCase().indexOf(o.toLowerCase())))return s;return null}(e,0,-1,n,t)}function o(e){var n=new RegExp("a=rtpmap:(\\d+) \\w+\\/\\d+"),t=e.match(n);return t&&2===t.length?t[1]:null}return{removeVPX:function(e){var i=t(e);return e=n(e,"vp9",i,!0),e=n(e,"vp8",i,!0)},disableNACK:function(e){if(!e||"string"!=typeof e)throw"Invalid arguments.";return e=(e=(e=(e=e.replace("a=rtcp-fb:126 nack\r\n","")).replace("a=rtcp-fb:126 nack pli\r\n","a=rtcp-fb:126 pli\r\n")).replace("a=rtcp-fb:97 nack\r\n","")).replace("a=rtcp-fb:97 nack pli\r\n","a=rtcp-fb:97 pli\r\n")},prioritize:function(e,n){if(n&&n.getSenders&&n.getSenders().length){if(!e||"string"!=typeof e)throw"Invalid arguments.";n.getSenders().forEach((function(n){for(var t=n.getParameters(),i=0;i<t.codecs.length;i++)if(t.codecs[i].mimeType==e){t.codecs.unshift(t.codecs.splice(i,1));break}n.setParameters(t)}))}},removeNonG722:function(e){return e.replace(/m=audio ([0-9]+) RTP\/SAVPF ([0-9 ]*)/g,"m=audio $1 RTP/SAVPF 9")},setApplicationSpecificBandwidth:function(e,n,t){return function(e,n,t){return n?("undefined"!=typeof isFirefox&&isFirefox||(t&&(n.screen?n.screen<300&&console.warn("It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail."):console.warn("It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.")),n.screen&&t&&(e=(e=e.replace(/b=AS([^\r\n]+\r\n)/g,"")).replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+n.screen+"\r\n")),(n.audio||n.video)&&(e=e.replace(/b=AS([^\r\n]+\r\n)/g,"")),n.audio&&(e=e.replace(/a=mid:audio\r\n/g,"a=mid:audio\r\nb=AS:"+n.audio+"\r\n")),n.screen?e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+n.screen+"\r\n"):n.video&&(e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+n.video+"\r\n"))),e):e}(e,n,t)},setVideoBitrates:function(e,n){return function(e,n){var t,r=(n=n||{}).min,s=n.max,a=e.split("\r\n"),d=i(a,"a=rtpmap","VP8/90000");if(d&&(t=o(a[d])),!t)return e;var c,u=i(a,"a=rtpmap","rtx/90000");if(u&&(c=o(a[u])),!u)return e;var l=i(a,"a=fmtp:"+c.toString());if(null!==l){var f="\r\n";f+="a=fmtp:"+t+" x-google-min-bitrate="+(r||"228")+"; x-google-max-bitrate="+(s||"228"),a[l]=a[l].concat(f),e=a.join("\r\n")}return e}(e,n)},setOpusAttributes:function(e,n){return function(e,n){n=n||{};var t,r=e.split("\r\n"),s=i(r,"a=rtpmap","opus/48000");if(s&&(t=o(r[s])),!t)return e;var a=i(r,"a=fmtp:"+t.toString());if(null===a)return e;var d="";return d+="; stereo="+(void 0!==n.stereo?n.stereo:"1"),d+="; sprop-stereo="+(void 0!==n["sprop-stereo"]?n["sprop-stereo"]:"1"),void 0!==n.maxaveragebitrate&&(d+="; maxaveragebitrate="+(n.maxaveragebitrate||1048576)),void 0!==n.maxplaybackrate&&(d+="; maxplaybackrate="+(n.maxplaybackrate||1048576)),void 0!==n.cbr&&(d+="; cbr="+(void 0!==n.cbr?n.cbr:"1")),void 0!==n.useinbandfec&&(d+="; useinbandfec="+n.useinbandfec),void 0!==n.usedtx&&(d+="; usedtx="+n.usedtx),void 0!==n.maxptime&&(d+="\r\na=maxptime:"+n.maxptime),r[a]=r[a].concat(d),e=r.join("\r\n")}(e,n)},preferVP9:function(n){return e(n,"vp9")},preferCodec:e,forceStereoAudio:function(e){for(var n=e.split("\r\n"),t=null,i=0;i<n.length;i++)if(-1!==n[i].search("opus/48000")){var o=extractSdp(n[i],/:(\d+) opus\/48000/i);break}for(i=0;i<n.length;i++){if(-1!==n[i].search("a=fmtp"))if(extractSdp(n[i],/a=fmtp:(\d+)/)===o){t=i;break}}return null===t?e:(n[t]=n[t].concat("; stereo=1; sprop-stereo=1"),e=n.join("\r\n"))}}}();window.BandwidthHandler=O;var D={processCandidates:function(e,n){var t=n.candidate,i=e.candidates,o=i.stun,r=i.turn;if(h(i.reflexive)||(o=i.reflexive),h(i.relay)||(r=i.relay),(i.host||!t.match(/typ host/g))&&(r||!t.match(/typ relay/g))&&(o||!t.match(/typ srflx/g))){var s=e.iceProtocols;if((s.udp||!t.match(/ udp /g))&&(s.tcp||!t.match(/ tcp /g)))return e.enableLogs&&console.debug("Your candidate pairs:",t),{candidate:t,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex}}}},A={getIceServers:function(e){return[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun.l.google.com:19302?transport=udp"]}]}};function L(e){if(!0!==currentUserMediaRequest.mutex){currentUserMediaRequest.mutex=!0;var n=JSON.stringify(e.localMediaConstraints);if(currentUserMediaRequest.streams[n])r(currentUserMediaRequest.streams[n].stream,!0);else{if(!!/BB10|BlackBerry/i.test(navigator.userAgent||"")||void 0===navigator.mediaDevices||"function"!=typeof navigator.mediaDevices.getUserMedia)return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,void navigator.getUserMedia(e.localMediaConstraints,(function(e){e.streamid=e.streamid||e.id||f(),e.idInstance=n,r(e)}),(function(n){e.onLocalMediaError(n,e.localMediaConstraints)}));if(void 0===navigator.mediaDevices){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;var t,i,o=function(){};navigator.mediaDevices={getUserMedia:function(e){return navigator.getUserMedia(e,(function(e){e(stream),t=stream}),(function(e){o(e),i=e})),{then:function(e){if(!t)return e,{then:function(e){i?e(i):o=e}};e(t)}}}}}if(!0===e.localMediaConstraints.isScreen){if(navigator.mediaDevices.getDisplayMedia)navigator.mediaDevices.getDisplayMedia(e.localMediaConstraints).then((function(e){e.streamid=e.streamid||e.id||f(),e.idInstance=n,r(e)})).catch((function(n){e.onLocalMediaError(n,e.localMediaConstraints)}));else{if(!navigator.getDisplayMedia)throw new Error("getDisplayMedia API is not availabe in this browser.");navigator.getDisplayMedia(e.localMediaConstraints).then((function(e){e.streamid=e.streamid||e.id||f(),e.idInstance=n,r(e)})).catch((function(n){e.onLocalMediaError(n,e.localMediaConstraints)}))}return}navigator.mediaDevices.getUserMedia(e.localMediaConstraints).then((function(e){e.streamid=e.streamid||e.id||f(),e.idInstance=n,r(e)})).catch((function(n){e.onLocalMediaError(n,e.localMediaConstraints)}))}}else currentUserMediaRequest.queueRequests.push(e);function r(t,i){!function(e,n){e.mandatory&&e.mandatory.chromeMediaSource||e.mozMediaSource||e.mediaSource?n.isScreen=!0:e.video?n.isVideo=!0:e.audio&&(n.isAudio=!0)}(e.localMediaConstraints,t);var o="ended";"oninactive"in t&&(o="inactive"),t.addEventListener(o,(function(){delete currentUserMediaRequest.streams[n],currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.indexOf(e)&&(delete currentUserMediaRequest.queueRequests[currentUserMediaRequest.queueRequests.indexOf(e)],currentUserMediaRequest.queueRequests=v(currentUserMediaRequest.queueRequests))}),!1),currentUserMediaRequest.streams[n]={stream:t},currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.length&&L(currentUserMediaRequest.queueRequests.shift()),e.onGettingLocalMedia(t,i)}}window.currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[],remove:function(e){this.mutex=!1;var n=this.streams[e];if(n){var t=(n=n.stream).currentUserMediaRequestOptions;this.queueRequests.indexOf(t)&&(delete this.queueRequests[this.queueRequests.indexOf(t)],this.queueRequests=v(this.queueRequests)),this.streams[e].stream=null,delete this.streams[e]}}};var U=function(){function e(e){if(e)return"string"==typeof e||void 0===e?e:e.audio&&e.video?null:e.audio?"audio":e.video?"video":void 0}return{setHandlers:function(n,t,i){if(n&&n.addEventListener){if(void 0===t||1==t){var o="ended";"oninactive"in n&&(o="inactive"),n.addEventListener(o,(function(){U.onSyncNeeded(this.streamid,o)}),!1)}n.mute=function(o,r){o=e(o),void 0!==r&&(t=r),void 0!==o&&"audio"!=o||C(n,"audio").forEach((function(e){e.enabled=!1,i.streamEvents[n.streamid].isAudioMuted=!0})),void 0!==o&&"video"!=o||C(n,"video").forEach((function(e){e.enabled=!1})),void 0!==t&&1!=t||U.onSyncNeeded(n.streamid,"mute",o),i.streamEvents[n.streamid].muteType=o||"both",u(n,"mute",o)},n.unmute=function(o,r){o=e(o),void 0!==r&&(t=r),function(){if(!i.streamEvents[n.streamid].mediaElement)return;var e=i.streamEvents[n.streamid].mediaElement;e.volume=0,function e(n,t,i,o){if((o=(o||0)+1)>=t)return;setTimeout((function(){i(),e(n,t,i,o)}),n)}(200,5,(function(){try{e.volume+=.2}catch(n){e.volume=1}}))}(),void 0!==o&&"audio"!=o||C(n,"audio").forEach((function(e){e.enabled=!0,i.streamEvents[n.streamid].isAudioMuted=!1})),void 0!==o&&"video"!=o||(C(n,"video").forEach((function(e){e.enabled=!0})),void 0!==o&&"video"==o&&i.streamEvents[n.streamid].isAudioMuted&&function e(t){t||(t=0),++t<100&&i.streamEvents[n.streamid].isAudioMuted&&(n.mute("audio"),setTimeout((function(){e(t)}),50))}()),void 0!==t&&1!=t||U.onSyncNeeded(n.streamid,"unmute",o),i.streamEvents[n.streamid].unmuteType=o||"both",u(n,"unmute",o)}}},onSyncNeeded:function(e,n,t){}}}();function I(e){var n={};return{receive:function(t,i,o){var r=t.uuid;if(n[r]||(n[r]=[]),n[r].push(t.message),t.last){var s=n[r].join("");t.isobject&&(s=JSON.parse(s));var a={data:s,userid:i,extra:o,latency:(new Date).getTime()-t.sendingTime};e.autoTranslateText?(a.original=a.data,e.Translator.TranslateText(a.data,(function(n){a.data=n,e.onmessage(a)}))):e.onmessage(a),delete n[r]}}}}var N={send:function(e){var n=e.connection,t=e.channel,i=e.remoteUserId,o=e.text,r=n.chunkSize||1e3,s="",a=!1;"string"!=typeof o&&(a=!0,o=JSON.stringify(o));var d=f(),c=(new Date).getTime();!function e(o,u){var l={type:"text",uuid:d,sendingTime:c};o&&(u=o,l.packets=parseInt(u.length/r));u.length>r?l.message=u.slice(0,r):(l.message=u,l.last=!0,l.isobject=a);t.send(l,i),(s=u.slice(l.message.length)).length&&setTimeout((function(){e(null,s)}),n.chunkInterval||100)}(o)}},W={handle:function(e){var n={};e.onFileStart=function(t){var i=document.createElement("div");if(i.title=t.name,i.innerHTML="<label>0%</label> <progress></progress>",t.remoteUserId&&(i.innerHTML+=" (Sharing with:"+t.remoteUserId+")"),e.filesContainer||(e.filesContainer=document.body||document.documentElement),e.filesContainer.insertBefore(i,e.filesContainer.firstChild),!t.remoteUserId)return n[t.uuid]={div:i,progress:i.querySelector("progress"),label:i.querySelector("label")},void(n[t.uuid].progress.max=t.maxChunks);n[t.uuid]||(n[t.uuid]={}),n[t.uuid][t.remoteUserId]={div:i,progress:i.querySelector("progress"),label:i.querySelector("label")},n[t.uuid][t.remoteUserId].progress.max=t.maxChunks},e.onFileProgress=function(e){var t=n[e.uuid];t&&(e.remoteUserId&&!(t=n[e.uuid][e.remoteUserId])||(t.progress.value=e.currentPosition||e.maxChunks||t.progress.max,function(e,n){if(-1!==e.position){var t=+e.position.toFixed(2).split(".")[1]||100;n.innerHTML=t+"%"}}(t.progress,t.label)))},e.onFileEnd=function(e){var t=n[e.uuid];if(t){if(!e.remoteUserId||(t=n[e.uuid][e.remoteUserId])){var i=t.div;-1!=e.type.indexOf("image")?i.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><img src="'+e.url+'" title="'+e.name+'" style="max-width: 80%;">':i.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><iframe src="'+e.url+'" title="'+e.name+'" style="width: 80%;border: 0;height: inherit;margin-top:1em;"></iframe>'}}else console.error("No such progress-helper element exist.",e)}}},V={handle:function(e){e.autoTranslateText=!1,e.language="en",e.googKey="AIzaSyCgB5hmFY74WYB-EoWkhr9cAGr6TiTHrEE",e.Translator={TranslateText:function(n,t){var i=document.createElement("script");i.type="text/javascript";var o=encodeURIComponent(n),r="method"+e.token();window[r]=function(e){e.data&&e.data.translations[0]&&t?t(e.data.translations[0].translatedText):e.error&&"Daily Limit Exceeded"===e.error.message?console.error('Text translation failed. Error message: "Daily Limit Exceeded."'):e.error?console.error(e.error.message):console.error(e)};var s="https://www.googleapis.com/language/translate/v2?key="+e.googKey+"&target="+(e.language||"en-US")+"&callback=window."+r+"&q="+o;i.src=s,document.getElementsByTagName("head")[0].appendChild(i)},getListOfLanguages:function(n){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(t.readyState==XMLHttpRequest.DONE){var e=JSON.parse(t.responseText);if(e&&e.data&&e.data.languages)return void n(e.data.languages);if(e.error&&"Daily Limit Exceeded"===e.error.message)return void console.error('Text translation failed. Error message: "Daily Limit Exceeded."');if(e.error)return void console.error(e.error.message);console.error(e)}};var i="https://www.googleapis.com/language/translate/v2/languages?key="+e.googKey+"&target=en";t.open("GET",i,!0),t.send(null)}}}};!function(e){s=s||{useDefaultDevices:!0},e.channel=e.sessionid=(r||location.href.replace(/\/|:|#|\?|\$|\^|%|\.|`|~|!|\+|@|\[|\||]|\|*. /g,"").split("\n").join("").split("\r").join(""))+"";var n=new c(e),t={};function i(n){if(e.socketAutoReConnect=!0,e.socket)n&&n(e.socket);else{if(void 0===d)if("undefined"!=typeof FirebaseConnection)window.SocketConnection=FirebaseConnection;else{if("undefined"==typeof PubNubConnection)throw"SocketConnection.js seems missed.";window.SocketConnection=PubNubConnection}new d(e,(function(t){n&&n(e.socket)}))}}function o(t,i){e.socket.emit("join-room",{sessionid:e.sessionid,session:e.session,mediaConstraints:e.mediaConstraints,sdpConstraints:e.sdpConstraints,streams:u(),extra:e.extra,password:void 0!==e.password&&"object"!=typeof e.password?e.password:""},(function(o,r){if(!0===o){if(e.enableLogs&&console.log("isRoomJoined: ",o," roomid: ",e.sessionid),e.peers[e.sessionid])return;n.onNegotiationNeeded(t)}!1===o&&e.enableLogs&&console.warn("isRoomJoined: ",r," roomid: ",e.sessionid),i(o,e.sessionid,r)}))}function a(n){e.enableLogs&&console.log("Sending open-room signal to socket.io"),e.waitingForLocalMedia=!1,e.socket.emit("open-room",{sessionid:e.sessionid,session:e.session,mediaConstraints:e.mediaConstraints,sdpConstraints:e.sdpConstraints,streams:u(),extra:e.extra,identifier:e.publicRoomIdentifier,password:void 0!==e.password&&"object"!=typeof e.password?e.password:""},(function(t,i){!0===t&&(e.enableLogs&&console.log("isRoomOpened: ",t," roomid: ",e.sessionid),n(t,e.sessionid)),!1===t&&(e.enableLogs&&console.warn("isRoomOpened: ",i," roomid: ",e.sessionid),n(t,e.sessionid,i))}))}function u(){try{return e.streamEvents.selectAll("local").map((function(e){return{streamid:e.streamid,tracks:e.stream.getTracks().length}}))}catch(e){return[]}}function v(t,i){if(e.dontCaptureUserMedia||t.isDataOnly)i();else{var o={};t.localPeerSdpConstraints.OfferToReceiveAudio&&(o.audio=e.mediaConstraints.audio),t.localPeerSdpConstraints.OfferToReceiveVideo&&(o.video=e.mediaConstraints.video);var r=t.session||e.session;r.oneway&&"two-way"!==r.audio&&"two-way"!==r.video&&"two-way"!==r.screen?i():(r.oneway&&r.audio&&"two-way"===r.audio&&(r={audio:!0}),(r.audio||r.video||r.screen)&&(r.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:S(e)}).then((function(t){t.isScreen=!0,n.onGettingLocalMedia(t),!r.audio&&!r.video||S(e)?i(t):e.invokeGetUserMedia(null,i)}),(function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")})):e.invokeGetUserMedia({audio:S(e),video:!0,isScreen:!0},!r.audio&&!r.video||S(e)?i:e.invokeGetUserMedia(null,i)):(r.audio||r.video)&&e.invokeGetUserMedia(null,i,r)))}}function h(n,t){n?(t.audio&&C(n,"audio").forEach((function(e){e.applyConstraints(t.audio)})),t.video&&C(n,"video").forEach((function(e){e.applyConstraints(t.video)}))):e.enableLogs&&console.error("No stream to applyConstraints.")}function y(t,i,o){i?n.replaceTrack(t,i,o):e.peers.getAllParticipants().forEach((function(e){n.replaceTrack(t,e,o)}))}n.onGettingLocalMedia=function(n,i){if(i=i||function(){},t[n.streamid])i();else{t[n.streamid]=!0;try{n.type="local"}catch(e){}e.setStreamEndHandler(n),m(n,(function(t){t.id=n.streamid,t.muted=!0,t.volume=0,-1===e.attachStreams.indexOf(n)&&e.attachStreams.push(n),void 0!==U&&U.setHandlers(n,!0,e),e.streamEvents[n.streamid]={stream:n,type:"local",mediaElement:t,userid:e.userid,extra:e.extra,streamid:n.streamid,isAudioMuted:!0};try{!function(e,n){if(n.stream&&C(n.stream,"audio").length){if(!e||!n)throw"Both arguments are required.";if(e.onspeaking&&e.onsilence){if("undefined"==typeof hark)throw"hark.js not found.";hark(n.stream,{onspeaking:function(){e.onspeaking(n)},onsilence:function(){e.onsilence(n)},onvolumechange:function(t,i){e.onvolumechange&&e.onvolumechange(merge({volume:t,threshold:i},n))}})}}}(e,e.streamEvents[n.streamid]),l(e,e.streamEvents[n.streamid]),e.onstream(e.streamEvents[n.streamid])}catch(e){}i()}),e)}},n.onGettingRemoteMedia=function(n,t){try{n.type="remote"}catch(e){}e.setStreamEndHandler(n,"remote-stream"),m(n,(function(i){i.id=n.streamid,void 0!==U&&U.setHandlers(n,!1,e),e.streamEvents[n.streamid]={stream:n,type:"remote",userid:t,extra:e.peers[t]?e.peers[t].extra:{},mediaElement:i,streamid:n.streamid},l(e,e.streamEvents[n.streamid]),e.onstream(e.streamEvents[n.streamid])}),e)},n.onRemovingRemoteMedia=function(n,t){var i=e.streamEvents[n.streamid];i||(i={stream:n,type:"remote",userid:t,extra:e.peers[t]?e.peers[t].extra:{},streamid:n.streamid,mediaElement:e.streamEvents[n.streamid]?e.streamEvents[n.streamid].mediaElement:null}),e.peersBackup[i.userid]&&(i.extra=e.peersBackup[i.userid].extra),e.onstreamended(i),delete e.streamEvents[n.streamid]},n.onNegotiationNeeded=function(n,t,o){o=o||function(){};var r={remoteUserId:t=t||n.remoteUserId,message:n=n||"",sender:e.userid};n.remoteUserId&&n.message&&n.sender&&(r=n),i((function(){e.socket.emit(e.socketMessageEvent,r,o)}))},n.onUserLeft=function(n){e.deletePeer(n)},n.disconnectWith=function(n,t){e.socket&&e.socket.emit("disconnect-with",n,t||function(){}),e.deletePeer(n)},e.socketOptions={transport:"polling"},e.openOrJoin=function(n,t){t=t||function(){},e.checkPresence(n,(function(n,i){if(n){e.sessionid=i;var r,s,d=!!e.session.oneway,c=g(e.session);s={OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},r={OfferToReceiveAudio:d?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:d?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo};var u={remoteUserId:e.sessionid,message:{newParticipationRequest:!0,isOneWay:d,isDataOnly:c,localPeerSdpConstraints:r,remotePeerSdpConstraints:s},sender:e.userid};v(u.message,(function(){o(u,t)}))}else e.waitingForLocalMedia=!0,e.isInitiator=!0,e.sessionid=i||e.sessionid,g(e.session)?a(t):e.captureUserMedia((function(){a(t)}))}))},e.waitingForLocalMedia=!1,e.open=function(n,t){t=t||function(){},e.waitingForLocalMedia=!0,e.isInitiator=!0,e.sessionid=n||e.sessionid,i((function(){g(e.session)?a(t):e.captureUserMedia((function(){a(t)}))}))},e.peersBackup={},e.deletePeer=function(n){if(n&&e.peers[n]){var t={userid:n,extra:e.peers[n]?e.peers[n].extra:{}};if(e.peersBackup[t.userid]&&(t.extra=e.peersBackup[t.userid].extra),e.onleave(t),e.peers[n]){e.peers[n].streams.forEach((function(e){e.stop()}));var i=e.peers[n].peer;if(i&&"closed"!==i.iceConnectionState)try{i.close()}catch(e){}e.peers[n]&&(e.peers[n].peer=null,delete e.peers[n])}}},e.rejoin=function(n){if(!e.isInitiator&&n&&Object.keys(n).length){var t={};e.peers[n.remoteUserId]&&(t=e.peers[n.remoteUserId].extra,e.deletePeer(n.remoteUserId)),n&&n.remoteUserId&&(e.join(n.remoteUserId),e.onReConnecting({userid:n.remoteUserId,extra:t}))}},e.join=function(n,t){e.sessionid=!!n&&(n.sessionid||n.remoteUserId||n)||e.sessionid,e.sessionid+="";var r=!1,s=!1,a=!1,d=!1;if(n&&n.session||!n||"string"==typeof n){var c=n&&n.session||e.session;a=!!c.oneway,d=g(c),s={OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},r={OfferToReceiveAudio:a?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:a?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo}}var u=function(){};"function"==typeof(t=t||{})&&(u=t,t={}),void 0!==t.localPeerSdpConstraints&&(r=t.localPeerSdpConstraints),void 0!==t.remotePeerSdpConstraints&&(s=t.remotePeerSdpConstraints),void 0!==t.isOneWay&&(a=t.isOneWay),void 0!==t.isDataOnly&&(d=t.isDataOnly);var l={remoteUserId:e.sessionid,message:{newParticipationRequest:!0,isOneWay:a,isDataOnly:d,localPeerSdpConstraints:r,remotePeerSdpConstraints:s},sender:e.userid};return v(l.message,(function(){i((function(){o(l,u)}))})),l},e.publicRoomIdentifier="",e.getUserMedia=e.captureUserMedia=function(t,i){t=t||function(){};var o=i||e.session;e.dontCaptureUserMedia||g(o)?t():(o.audio||o.video||o.screen)&&(o.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:S(e)}).then((function(r){if(r.isScreen=!0,n.onGettingLocalMedia(r),!o.audio&&!o.video||S(e))t(r);else{var s={};for(var a in o)"screen"!==a&&(s[a]=o[a]);e.invokeGetUserMedia(i,t,s)}}),(function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")})):e.invokeGetUserMedia({audio:S(e),video:!0,isScreen:!0},(function(n){if(!o.audio&&!o.video||S(e))t(n);else{var r={};for(var s in o)"screen"!==s&&(r[s]=o[s]);e.invokeGetUserMedia(i,t,r)}})):(o.audio||o.video)&&e.invokeGetUserMedia(i,t,o))},e.onbeforeunload=function(t,i){e.closeBeforeUnload&&(e.peers.getAllParticipants().forEach((function(t){n.onNegotiationNeeded({userLeft:!0},t),e.peers[t]&&e.peers[t].peer&&e.peers[t].peer.close(),delete e.peers[t]})),i||e.closeSocket(),e.isInitiator=!1)},window.ignoreBeforeUnload?e.closeBeforeUnload=!1:(e.closeBeforeUnload=!0,window.addEventListener("beforeunload",e.onbeforeunload,!1)),e.userid=f(),e.changeUserId=function(n,t){t=t||function(){},e.userid=n||f(),e.socket.emit("changed-uuid",e.userid,t)},e.extra={},e.attachStreams=[],e.session={audio:!0,video:!0},e.enableFileSharing=!1,e.bandwidth={screen:!1,audio:!1,video:!1},e.codecs={audio:"opus",video:"VP9"},e.processSdp=function(n){return b()||"Safari"===DetectRTC.browser.name?n:("VP8"===e.codecs.video.toUpperCase()&&(n=O.preferCodec(n,"vp8")),"VP9"===e.codecs.video.toUpperCase()&&(n=O.preferCodec(n,"vp9")),"H264"===e.codecs.video.toUpperCase()&&(n=O.preferCodec(n,"h264")),"G722"===e.codecs.audio&&(n=O.removeNonG722(n)),"Firefox"===DetectRTC.browser.name||((e.bandwidth.video||e.bandwidth.screen)&&(n=O.setApplicationSpecificBandwidth(n,e.bandwidth,!!e.session.screen)),e.bandwidth.video&&(n=O.setVideoBitrates(n,{min:8*e.bandwidth.video*1024,max:8*e.bandwidth.video*1024})),e.bandwidth.audio&&(n=O.setOpusAttributes(n,{maxaveragebitrate:8*e.bandwidth.audio*1024,maxplaybackrate:8*e.bandwidth.audio*1024,stereo:1,maxptime:3}))),n)},void 0!==O&&(e.BandwidthHandler=e.CodecsHandler=O),e.mediaConstraints={audio:{mandatory:{},optional:e.bandwidth.audio?[{bandwidth:8*e.bandwidth.audio*1024||1048576}]:[]},video:{mandatory:{},optional:e.bandwidth.video?[{bandwidth:8*e.bandwidth.video*1024||1048576},{facingMode:"user"}]:[{facingMode:"user"}]}},"Firefox"===DetectRTC.browser.name&&(e.mediaConstraints={audio:!0,video:!0}),s.useDefaultDevices||DetectRTC.isMobileDevice||DetectRTC.load((function(){var n,t;if(DetectRTC.MediaDevices.forEach((function(i){"audioinput"===i.kind&&!1!==e.mediaConstraints.audio&&(n=i),"videoinput"===i.kind&&!1!==e.mediaConstraints.video&&(t=i)})),n){if("Firefox"===DetectRTC.browser.name)return void(!0!==e.mediaConstraints.audio?e.mediaConstraints.audio.deviceId=n.id:e.mediaConstraints.audio={deviceId:n.id});1==e.mediaConstraints.audio&&(e.mediaConstraints.audio={mandatory:{},optional:[]}),e.mediaConstraints.audio.optional||(e.mediaConstraints.audio.optional=[]);var i=[{sourceId:n.id}];e.mediaConstraints.audio.optional=i.concat(e.mediaConstraints.audio.optional)}if(t){if("Firefox"===DetectRTC.browser.name)return void(!0!==e.mediaConstraints.video?e.mediaConstraints.video.deviceId=t.id:e.mediaConstraints.video={deviceId:t.id});1==e.mediaConstraints.video&&(e.mediaConstraints.video={mandatory:{},optional:[]}),e.mediaConstraints.video.optional||(e.mediaConstraints.video.optional=[]);i=[{sourceId:t.id}];e.mediaConstraints.video.optional=i.concat(e.mediaConstraints.video.optional)}})),e.sdpConstraints={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},optional:[{VoiceActivityDetection:!1}]},e.sdpSemantics=null,e.iceCandidatePoolSize=null,e.bundlePolicy=null,e.rtcpMuxPolicy=null,e.iceTransportPolicy=null,e.optionalArgument={optional:[{DtlsSrtpKeyAgreement:!0},{googImprovedWifiBwe:!0},{googScreencastMinBitrate:300},{googIPv6:!0},{googDscp:!0},{googCpuUnderuseThreshold:55},{googCpuOveruseThreshold:85},{googSuspendBelowMinBitrate:!0},{googCpuOveruseDetection:!0}],mandatory:{}},e.iceServers=A.getIceServers(e),e.candidates={host:!0,stun:!0,turn:!0},e.iceProtocols={tcp:!0,udp:!0},e.onopen=function(n){e.enableLogs&&console.info("Data connection has been opened between you & ",n.userid)},e.onclose=function(n){e.enableLogs&&console.warn("Data connection has been closed between you & ",n.userid)},e.onerror=function(n){e.enableLogs&&console.error(n.userid,"data-error",n)},e.onmessage=function(n){e.enableLogs&&console.debug("data-message",n.userid,n.data)},e.send=function(n,t){e.peers.send(n,t)},e.close=e.disconnect=e.leave=function(){e.onbeforeunload(!1,!0)},e.closeEntireSession=function(n){n=n||function(){},e.socket.emit("close-entire-session",(function t(){e.getAllParticipants().length?setTimeout(t,100):(e.onEntireSessionClosed({sessionid:e.sessionid,userid:e.userid,extra:e.extra}),e.changeUserId(null,(function(){e.close(),n()})))}))},e.onEntireSessionClosed=function(n){e.enableLogs&&console.info("Entire session is closed: ",n.sessionid,n.extra)},e.onstream=function(n){var t=e.videosContainer;t.insertBefore(n.mediaElement,t.firstChild);var i=n.mediaElement.play();void 0===i?setTimeout((function(){n.mediaElement.play()}),2e3):i.catch((function(){})).then((function(){setTimeout((function(){n.mediaElement.play()}),2e3)}))},e.onstreamended=function(e){e.mediaElement||(e.mediaElement=document.getElementById(e.streamid)),e.mediaElement&&e.mediaElement.parentNode&&e.mediaElement.parentNode.removeChild(e.mediaElement)},e.direction="many-to-many",e.removeStream=function(n,t){var i;e.attachStreams.forEach((function(e){e.id===n&&(i=e)})),i?(e.peers.getAllParticipants().forEach((function(n){if(!t||n===t){var o=e.peers[n];try{o.peer.removeStream(i)}catch(e){}}})),e.renegotiate()):console.warn("No such stream exist.",n)},e.addStream=function(t,i){if(t.getTracks)return-1===e.attachStreams.indexOf(t)&&(t.streamid||(t.streamid=t.id),e.attachStreams.push(t)),void e.renegotiate(i);function o(n){t.streamCallback&&t.streamCallback(n),e.renegotiate(i)}g(t)?e.renegotiate(i):(t.audio||t.video||t.screen)&&(t.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:S(e)}).then((function(i){i.isScreen=!0,n.onGettingLocalMedia(i),!t.audio&&!t.video||S(e)?o(i):e.invokeGetUserMedia(null,(function(e){o(e)}))}),(function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")})):e.invokeGetUserMedia({audio:S(e),video:!0,isScreen:!0},(function(n){!t.audio&&!t.video||S(e)?o(n):e.invokeGetUserMedia(null,(function(e){o(e)}))})):(t.audio||t.video)&&e.invokeGetUserMedia(null,o))},e.invokeGetUserMedia=function(t,i,o){o||(o=e.session),t||(t=e.mediaConstraints),L({onGettingLocalMedia:function(e){var o=t.video;o&&(o.mediaSource||o.mozMediaSource||o.mandatory&&o.mandatory.chromeMediaSource)&&(e.isScreen=!0),e.isScreen||(e.isVideo=!!C(e,"video").length,e.isAudio=!e.isVideo&&C(e,"audio").length),n.onGettingLocalMedia(e,(function(){"function"==typeof i&&i(e)}))},onLocalMediaError:function(e,t){n.onLocalMediaError(e,t)},localMediaConstraints:t||{audio:!!o.audio&&t.audio,video:!!o.video&&t.video}})},e.applyConstraints=function(n,t){if(P&&P.prototype.applyConstraints){var i;if(t)return e.streamEvents[t]&&(i=e.streamEvents[t].stream),void h(i,n);e.attachStreams.forEach((function(e){h(e,n)}))}else alert("track.applyConstraints is NOT supported in your browser.")},e.replaceTrack=function(t,i,o){if(t=t||{},k.prototype.getSenders)if(t instanceof P)y(t,i,o);else{if(t instanceof w)return C(t,"video").length&&y(C(t,"video")[0],i,!0),void(C(t,"audio").length&&y(C(t,"audio")[0],i,!1));if(g(t))throw"connection.replaceTrack requires audio and/or video and/or screen.";(t.audio||t.video||t.screen)&&(t.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:S(e)}).then((function(i){i.isScreen=!0,n.onGettingLocalMedia(i),!t.audio&&!t.video||S(e)?r(i):e.invokeGetUserMedia(null,r)}),(function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")})):e.invokeGetUserMedia({audio:S(e),video:!0,isScreen:!0},!t.audio&&!t.video||S(e)?r:e.invokeGetUserMedia(null,r)):(t.audio||t.video)&&e.invokeGetUserMedia(null,r))}else e.addStream(t);function r(n){e.replaceTrack(n,i,o||t.video||t.screen)}},e.resetTrack=function(n,t){n||(n=e.getAllParticipants()),"string"==typeof n&&(n=[n]),n.forEach((function(n){var i=e.peers[n].peer;void 0!==t&&!0!==t||!i.lastVideoTrack||e.replaceTrack(i.lastVideoTrack,n,!0),void 0!==t&&!1!==t||!i.lastAudioTrack||e.replaceTrack(i.lastAudioTrack,n,!1)}))},e.renegotiate=function(t){t?n.renegotiatePeer(t):e.peers.getAllParticipants().forEach((function(e){n.renegotiatePeer(e)}))},e.setStreamEndHandler=function(n,t){if(n&&n.addEventListener&&(t=!!t,!n.alreadySetEndHandler)){n.alreadySetEndHandler=!0;var i="ended";"oninactive"in n&&(i="inactive"),n.addEventListener(i,(function(){if(n.idInstance&&currentUserMediaRequest.remove(n.idInstance),!t){var i=[];e.attachStreams.forEach((function(e){e.id!=n.id&&i.push(e)})),e.attachStreams=i}var o=e.streamEvents[n.streamid];if(o||(o={stream:n,streamid:n.streamid,type:t?"remote":"local",userid:e.userid,extra:e.extra,mediaElement:e.streamEvents[n.streamid]?e.streamEvents[n.streamid].mediaElement:null}),t&&e.peers[o.userid]){var r=e.peers[o.userid].peer;i=[];r.getRemoteStreams().forEach((function(e){e.id!=n.id&&i.push(e)})),e.peers[o.userid].streams=i}o.userid===e.userid&&"remote"===o.type||(e.peersBackup[o.userid]&&(o.extra=e.peersBackup[o.userid].extra),e.onstreamended(o),delete e.streamEvents[n.streamid])}),!1)}},e.onMediaError=function(n,t){e.enableLogs&&console.error(n,t)},e.autoCloseEntireSession=!1,e.filesContainer=e.videosContainer=document.body||document.documentElement,e.isInitiator=!1,e.shareFile=n.shareFile,void 0!==W&&W.handle(e),void 0!==V&&V.handle(e),e.token=f,e.onNewParticipant=function(n,t){e.acceptParticipationRequest(n,t)},e.acceptParticipationRequest=function(e,t){t.successCallback&&(t.successCallback(),delete t.successCallback),n.createNewPeer(e,t)},void 0!==U&&(e.StreamsHandler=U),e.onleave=function(e){},e.invokeSelectFileDialog=function(e){var n=new FileSelector;n.accept="*.*",n.selectSingleFile(e)},e.onmute=function(e){if(e&&e.mediaElement)if("both"===e.muteType||"video"===e.muteType){e.mediaElement.src=null;var n=e.mediaElement.pause();void 0!==n?n.then((function(){e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"})):e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"}else"audio"===e.muteType&&(e.mediaElement.muted=!0)},e.onunmute=function(e){e&&e.mediaElement&&e.stream&&("both"===e.unmuteType||"video"===e.unmuteType?(e.mediaElement.poster=null,e.mediaElement.srcObject=e.stream,e.mediaElement.play()):"audio"===e.unmuteType&&(e.mediaElement.muted=!1))},e.onExtraDataUpdated=function(n){n.status="online",e.onUserStatusChanged(n,!0)},e.getAllParticipants=function(n){return e.peers.getAllParticipants(n)},void 0!==U&&(U.onSyncNeeded=function(t,i,o){e.peers.getAllParticipants().forEach((function(e){n.onNegotiationNeeded({streamid:t,action:i,streamSyncNeeded:!0,type:o||"both"},e)}))}),e.connectSocket=function(e){i(e)},e.closeSocket=function(){try{io.sockets={}}catch(e){}e.socket&&("function"==typeof e.socket.disconnect&&e.socket.disconnect(),"function"==typeof e.socket.resetProps&&e.socket.resetProps(),e.socket=null)},e.getSocket=function(n){return!n&&e.enableLogs&&console.warn("getSocket.callback paramter is required."),n=n||function(){},e.socket?n(e.socket):i((function(){n(e.socket)})),e.socket},e.getRemoteStreams=n.getRemoteStreams;var T=["selectFirst","selectAll","forEach"];if(e.streamEvents={selectFirst:function(n){return e.streamEvents.selectAll(n)[0]},selectAll:function(n){n||(n={local:!0,remote:!0,isScreen:!0,isAudio:!0,isVideo:!0}),"local"==n&&(n={local:!0}),"remote"==n&&(n={remote:!0}),"screen"==n&&(n={isScreen:!0}),"audio"==n&&(n={isAudio:!0}),"video"==n&&(n={isVideo:!0});var t=[];return Object.keys(e.streamEvents).forEach((function(i){var o=e.streamEvents[i];if(-1===T.indexOf(i)){var r=!0;n.local&&"local"===o.type&&(r=!1),n.remote&&"remote"===o.type&&(r=!1),n.isScreen&&o.stream.isScreen&&(r=!1),n.isVideo&&o.stream.isVideo&&(r=!1),n.isAudio&&o.stream.isAudio&&(r=!1),n.userid&&o.userid===n.userid&&(r=!1),!1===r&&t.push(o)}})),t}},e.socketURL="/",e.socketMessageEvent="RTCMultiConnection-Message",e.socketCustomEvent="RTCMultiConnection-Custom-Message",e.DetectRTC=DetectRTC,e.setCustomSocketEvent=function(n){n&&(e.socketCustomEvent=n),e.socket&&e.socket.emit("set-custom-socket-event-listener",e.socketCustomEvent)},e.getNumberOfBroadcastViewers=function(n,t){e.socket&&n&&t&&e.socket.emit("get-number-of-users-in-specific-broadcast",n,t)},e.onNumberOfBroadcastViewersUpdated=function(n){e.enableLogs&&e.isInitiator&&console.info("Number of broadcast (",n.broadcastId,") viewers",n.numberOfBroadcastViewers)},e.onUserStatusChanged=function(n,t){e.enableLogs&&!t&&console.info(n.userid,n.status)},e.getUserMediaHandler=L,e.multiPeersHandler=n,e.enableLogs=!0,e.setCustomSocketHandler=function(e){void 0!==d&&(d=e)},e.chunkSize=4e4,e.maxParticipantsAllowed=1e3,e.disconnectWith=n.disconnectWith,e.checkPresence=function(n,t){n=n||e.sessionid,"SSEConnection"!==d.name?e.socket?e.socket.emit("check-presence",n+"",(function(n,i,o){e.enableLogs&&console.log("checkPresence.isRoomExist: ",n," roomid: ",i),t(n,i,o)})):e.connectSocket((function(){e.checkPresence(n,t)})):SSEConnection.checkPresence(n,(function(n,i,o){if(!e.socket)return n||(e.userid=i),void e.connectSocket((function(){t(n,i,o)}));t(n,i)}))},e.onReadyForOffer=function(n,t){e.multiPeersHandler.createNewPeer(n,t)},e.setUserPreferences=function(n){return e.dontAttachStream&&(n.dontAttachLocalStream=!0),e.dontGetRemoteStream&&(n.dontGetRemoteStream=!0),n},e.updateExtraData=function(){e.socket.emit("extra-data-updated",e.extra)},e.enableScalableBroadcast=!1,e.maxRelayLimitPerUser=3,e.dontCaptureUserMedia=!1,e.dontAttachStream=!1,e.dontGetRemoteStream=!1,e.onReConnecting=function(n){e.enableLogs&&console.info("ReConnecting with",n.userid,"...")},e.beforeAddingStream=function(e){return e},e.beforeRemovingStream=function(e){return e},"undefined"!=typeof isChromeExtensionAvailable&&(e.checkIfChromeExtensionAvailable=isChromeExtensionAvailable),"undefined"!=typeof isFirefoxExtensionAvailable&&(e.checkIfChromeExtensionAvailable=isFirefoxExtensionAvailable),"undefined"!=typeof getChromeExtensionStatus&&(e.getChromeExtensionStatus=getChromeExtensionStatus),e.modifyScreenConstraints=function(e){return e},e.onPeerStateChanged=function(n){e.enableLogs&&-1!==n.iceConnectionState.search(/closed|failed/gi)&&console.error("Peer connection is closed between you & ",n.userid,n.extra,"state:",n.iceConnectionState)},e.isOnline=!0,p("online",(function(){e.isOnline=!0})),p("offline",(function(){e.isOnline=!1})),e.isLowBandwidth=!1,navigator&&navigator.connection&&navigator.connection.type&&(e.isLowBandwidth=-1!==navigator.connection.type.toString().toLowerCase().search(/wifi|cell/g),e.isLowBandwidth)){if(e.bandwidth={audio:!1,video:!1,screen:!1},e.mediaConstraints.audio&&e.mediaConstraints.audio.optional&&e.mediaConstraints.audio.optional.length){var R=[];e.mediaConstraints.audio.optional.forEach((function(e){void 0===e.bandwidth&&R.push(e)})),e.mediaConstraints.audio.optional=R}if(e.mediaConstraints.video&&e.mediaConstraints.video.optional&&e.mediaConstraints.video.optional.length){R=[];e.mediaConstraints.video.optional.forEach((function(e){void 0===e.bandwidth&&R.push(e)})),e.mediaConstraints.video.optional=R}}e.getExtraData=function(n,t){if(!n)throw"remoteUserId is required.";if("function"!=typeof t)return e.peers[n]?e.peers[n].extra:e.peersBackup[n]?e.peersBackup[n].extra:{};e.socket.emit("get-remote-user-extra-data",n,(function(e,n,i){t(e,n,i)}))},s.autoOpenOrJoin&&e.openOrJoin(e.sessionid),e.onUserIdAlreadyTaken=function(n,t){e.close(),e.closeSocket(),e.isInitiator=!1,e.userid=e.token(),e.join(e.sessionid),e.enableLogs&&console.warn("Userid already taken.",n,"Your new userid:",e.userid)},e.trickleIce=!0,e.version="3.6.9",e.onSettingLocalDescription=function(n){e.enableLogs&&console.info("Set local description for remote user",n.userid)},e.resetScreen=function(){sourceId=null,DetectRTC&&DetectRTC.screen&&delete DetectRTC.screen.sourceId,currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[]}},e.autoCreateMediaElement=!0,e.password=null,e.setPassword=function(n,t){t=t||function(){},e.socket?e.socket.emit("set-password",n,t):(e.password=n,t(!0,e.sessionid,null))},e.onSocketDisconnect=function(n){e.enableLogs&&console.warn("socket.io connection is closed")},e.onSocketError=function(n){e.enableLogs&&console.warn("socket.io connection is failed")},e.errors={ROOM_NOT_AVAILABLE:"Room not available",INVALID_PASSWORD:"Invalid password",USERID_NOT_AVAILABLE:"User ID does not exist",ROOM_PERMISSION_DENIED:"Room permission denied",ROOM_FULL:"Room full",DID_NOT_JOIN_ANY_ROOM:"Did not join any room yet",INVALID_SOCKET:"Invalid socket",PUBLIC_IDENTIFIER_MISSING:"publicRoomIdentifier is required",INVALID_ADMIN_CREDENTIAL:"Invalid username or password attempted"}}(this)};e.exports=n=r,void 0===(o=function(){return r}.apply(n,[]))||(e.exports=o)}).call(this,t("yLpj"),t("8oxB"))}}]);
//# sourceMappingURL=live.js.map?id=b854d9edc46b11932f70